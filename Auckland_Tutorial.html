

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>EMRI Waveforms in a nutshell &#8212; AL Experiments</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Auckland_Tutorial';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">AL Experiments</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/avivajpeyi/active_learning_experiments" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/avivajpeyi/active_learning_experiments/issues/new?title=Issue%20on%20page%20%2FAuckland_Tutorial.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Auckland_Tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>EMRI Waveforms in a nutshell</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">EMRI Waveforms in a nutshell</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-an-extreme-mass-ratio-inspiral">What is an Extreme Mass Ratio Inspiral?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#emri-waveforms">EMRI Waveforms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#each-harmonics-is-characterized-by-three-important-functions-these-will-be-also-different-modules-in-the-code">Each harmonics is characterized by three important functions (these will be also different modules in the code):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-remarks">General Remarks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#emri-parameter-space">EMRI Parameter space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#schwarzschild-eccentric-waveforms">Schwarzschild Eccentric Waveforms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trajectory-module">Trajectory Module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-us-being-by-analysing-a-basic-trajectory">Let us being by analysing a basic trajectory</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-0">Exercise 0</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quasi-keplerian-parameters-p-e">Quasi-Keplerian parameters: <span class="math notranslate nohighlight">\((p,e)\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evolution-of-semi-latus-rectum-and-eccentricity">Evolution of semi-latus rectum and eccentricity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trajectory-duration-as-a-function-of-mass-ratio-eccentricity-semi-latus-rectum">Trajectory duration as a function of mass ratio, eccentricity, semi-latus rectum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-of-plot-above">Discussion of plot above</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#number-of-cycles-and-differences-between-trajectories">Number of cycles and differences between trajectories</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fundamental-frequencies-and-harmonics">Fundamental frequencies and harmonics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#schwarzchild-waveforms-in-the-source-frame">Schwarzchild Waveforms in the source frame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#emri-waveforms-in-different-domains">EMRI Waveforms in different domains</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-domain">Time Domain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier-domain">Fourier Domain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-frequency-domain">Time-Frequency Domain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#end-of-tutorial">End of Tutorial</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#augmented-analytic-kludge-with-5pn-trajectory">Augmented Analytic Kludge with 5PN trajectory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pn-trajectory">5PN Trajectory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-an-aak-waveform-from-a-given-trajectory-in-this-case-the-5pn-trajectory">Building an AAK waveform from a given trajectory (in this case the 5PN trajectory)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-the-new-aak-with-the-generic-waveform-generator">Generating the new AAK with the generic waveform generator</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mode-selection-for-schwarszchild-waveforms">Mode Selection for Schwarszchild Waveforms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mode-selection-by-power-contribution">Mode selection by power contribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specific-mode-selection">Specific mode selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#producing-waveforms-with-the-generic-interface">Producing waveforms with the generic interface</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling-of-the-waveform-with-the-central-black-hole-mass">Scaling of the waveform with the central black hole mass</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-extrinsic-parameters-in-the-solar-system-barycenter-frame">Understanding the extrinsic parameters in the Solar System Barycenter frame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citing-waveforms-and-modules">Citing waveforms and modules</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fast-schwarzschild-eccentric-waveforms">Fast Schwarzschild Eccentric Waveforms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#new-and-improved-aak-with-5pn-trajectory">New and Improved AAK with 5PN Trajectory</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions">Solutions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-1">Ex 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-2">Ex 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-3">Ex 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-4">Ex 4</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-5">Ex 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-6">Ex 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-7">Ex 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-8">Ex 8</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="emri-waveforms-in-a-nutshell">
<h1>EMRI Waveforms in a nutshell<a class="headerlink" href="#emri-waveforms-in-a-nutshell" title="Permalink to this heading">#</a></h1>
<p>Here you can find a pedagogical tutorial on creating Extreme Mass Ratio Inspiral (EMRI) waveforms. We will make an extensive use of the Fast EMRI Waveform (FEW) package <a class="reference external" href="https://arxiv.org/abs/2104.04582">arxiv.org/2104.04582</a> <a class="reference external" href="https://arxiv.org/abs/2008.06071">arxiv.org/2008.06071</a>. The waveforms in this package combine a variety of separately accessible modules to form EMRI waveforms on both CPUs and GPUs. Generally, the modules fall into four categories: trajectory, amplitudes, summation, and utilities. Please see the <a class="reference external" href="https://bhptoolkit.org/FastEMRIWaveforms/">documentation</a> for further information on these modules. The code and installation instructions can be found on Github <a class="reference external" href="https://github.com/BlackHolePerturbationToolkit/FastEMRIWaveforms">here</a>.</p>
<p>In this tutorial will cover the basics of EMRI waveforms. In particular, we will understand:</p>
<ol class="arabic simple">
<li><p>What is an Extreme Mass Ratio Inspiral?</p></li>
<li><p>How is an EMRI Waveform built? What are the parameters of an EMRI Waveform?</p></li>
<li><p>EMRI Trajectories</p></li>
<li><p>EMRI Amplitudes and harmonic content</p></li>
<li><p>EMRI Waveforms</p></li>
<li><p>How to modify a trajectory and build your own waveform</p></li>
</ol>
<section id="what-is-an-extreme-mass-ratio-inspiral">
<h2>What is an Extreme Mass Ratio Inspiral?<a class="headerlink" href="#what-is-an-extreme-mass-ratio-inspiral" title="Permalink to this heading">#</a></h2>
<p>One of the primary sources for the future space-based gravitational wave detector, the Laser Interferometer Space Antenna, are the inspirals of small compact objects into massive black holes in the centers of galaxies. Such binaries are characterized by a small compact object of mass typically <span class="math notranslate nohighlight">\(\mu\in[1,100]M_\odot\)</span> (for example a solar-mass black hole or a neutron star) inspiralling around a Massive Black Hole (MBH) of mass <span class="math notranslate nohighlight">\(M\in[10^5,10^7]M_\odot\)</span>. Due to their particularly small mass ratio <span class="math notranslate nohighlight">\(\epsilon = \mu / M \sim [10^{-4},10^{-6}]\)</span> these systems are called Extreme Mass Ratio Inspiral (EMRI). Using perturbation theory in the mass ratio <span class="math notranslate nohighlight">\(\epsilon\)</span> it is possible to model the evolution of the orbit of the compact object. On short time-scales (order of the orbital period), the compact object moves on geodesic orbits as if it was a test particles. However, on longer time-scales, it is necessary to take into account the impact of the gravitational field of the compact object on the background and the gravitational wave emission. During the inspiral, the compact object is slowly driven away from geodesic orbits and this deviation can be interpreted as an effective acceleration/force due to the so-called Gravitational <a class="reference external" href="https://arxiv.org/abs/1805.10385">Self-Force</a>.</p>
<p>Below, in the left panel, we show an example of a small compact object of ten solar masses inspiraling around a spinning MBH of <span class="math notranslate nohighlight">\(10^6\)</span> solar masses. The duration of the animation corresponds to 8 hours. In the right panel, you can see the gravitational wave signal emmitted during this inspiral.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%HTML</span>
<span class="p">&lt;</span><span class="nt">video</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;420&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;340&quot;</span> <span class="na">controls</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">source</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;EMRI_orbit.mp4&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;video/mp4&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">video</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">video</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;420&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;340&quot;</span> <span class="na">controls</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">source</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;EMRI_waveform.mp4&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;video/mp4&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">video</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><video width="420" height="340" controls>
  <source src="EMRI_orbit.mp4" type="video/mp4">
</video>
<video width="420" height="340" controls>
  <source src="EMRI_waveform.mp4" type="video/mp4">
</video>
</div></div>
</div>
</section>
<section id="emri-waveforms">
<h2>EMRI Waveforms<a class="headerlink" href="#emri-waveforms" title="Permalink to this heading">#</a></h2>
<p>EMRI waveforms are represented by the complex time-domain dimensionless strain <span class="math notranslate nohighlight">\(h(t) = h_+ - ih_\times\)</span>, where <span class="math notranslate nohighlight">\(h_+\)</span> and <span class="math notranslate nohighlight">\(h_\times\)</span> are the normal transverse-traceless gravitational wave polarizations. For large distances from the source (<span class="math notranslate nohighlight">\(d_{L}\rightarrow \infty\)</span>), <span class="math notranslate nohighlight">\(h\)</span> is given in the source frame by:
\begin{equation}\label{eq:main_wave}
h = \frac{\mu}{d_L}\sum_{lmkn} A_{lmkn}(t) , S_{lmkn}(\theta,\phi) , \exp[-i\Phi_{mkn}(t)].
\end{equation}
Here <span class="math notranslate nohighlight">\(\mu\)</span> is the mass of the secondary body, <span class="math notranslate nohighlight">\(d_{L}\)</span> the luminosity distance to the source, <span class="math notranslate nohighlight">\(t\)</span> is the time of arrival of the gravitational wave at the solar system baricenter, and <span class="math notranslate nohighlight">\((l,m,k,n)\)</span> are the indices describing the frequency-domain harmonic mode decomposition (or simply “harmonic” or “mode”):</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(l\)</span> denotes the orbital angular momentum mode index and can take the value <span class="math notranslate nohighlight">\(l=2,3,...\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> denotes the azimuthal mode index and can take the values from <span class="math notranslate nohighlight">\(-l\)</span> up to <span class="math notranslate nohighlight">\(l\)</span>. For example for l=2, <span class="math notranslate nohighlight">\(m=-2, -1, 0, 1, 2\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(n\)</span> denote the polar and radial mode indices and can take values from <span class="math notranslate nohighlight">\(-\infty\)</span> up to <span class="math notranslate nohighlight">\(+\infty\)</span>. But in practice they are restriced to values around zero, for instance between <span class="math notranslate nohighlight">\(-30\)</span> up to <span class="math notranslate nohighlight">\(30\)</span></p></li>
</ul>
<p>For LIGO sources, where the two objects have comparable masses, the strongest mode is the <span class="math notranslate nohighlight">\((l=2,m=2,k=0,n=0)\)</span>.
See <a class="reference external" href="https://arxiv.org/abs/gr-qc/0509101">Drasco and Hughes 2006</a> and <a class="reference external" href="https://arxiv.org/pdf/2102.02713.pdf">Hughes+ 2021</a> for a derivation of the gravitational waveform.</p>
<section id="each-harmonics-is-characterized-by-three-important-functions-these-will-be-also-different-modules-in-the-code">
<h3>Each harmonics is characterized by three important functions (these will be also different modules in the code):<a class="headerlink" href="#each-harmonics-is-characterized-by-three-important-functions-these-will-be-also-different-modules-in-the-code" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>The oscillatory part <span class="math notranslate nohighlight">\(\exp[-i\Phi_{mkn}(t)]\)</span> is determined by the phase <span class="math notranslate nohighlight">\(\Phi_{mkn}=m\Phi_\varphi + k \Phi_\theta + n\Phi_r\)</span>. The phases <span class="math notranslate nohighlight">\(\Phi_{\varphi,\theta,r}\)</span> are determined solving for the EMRI trajectory, i.e. the following system of ordinary differential equations:
\begin{align}
\frac{d}{dt}p &amp;= \epsilon , f^{(1)}<em>p(a, p, e, x_I) + \mathcal{O}(\epsilon^2)\
\frac{d}{dt}e &amp;= \epsilon , f^{(1)}<em>e(a, p, e, x_I) + \mathcal{O}(\epsilon^2)\
\frac{d}{dt}x_I &amp;= \epsilon , f^{(0)}</em>{x_I}(a, p, e, x_I) + \mathcal{O}(\epsilon^2)\
\frac{d}{dt}\Phi</em>{\varphi,\theta,r} &amp;= \Omega_{\varphi, \theta, r}(a, p, e, x_I)/M + \mathcal{O}(\epsilon)
\end{align}
with initial condition <span class="math notranslate nohighlight">\(\{\Phi_{\varphi0},\Phi_{\theta0},\Phi_{r0},p_0,e_0,x_{I0}\}\)</span>. The frequencies <span class="math notranslate nohighlight">\(\Omega_{r,\theta,\phi}\)</span> describe the fundamental frequencies of a Kerr geodesic orbit and in the Newtonian limit (weak field) they all converge to the Keplerian frequency. These frequencies are determined using the dimensionless spin of the MBH, <span class="math notranslate nohighlight">\(a\)</span>, and the quasi-Keplerian orbital parameters of <span class="math notranslate nohighlight">\(p\)</span> (semi-latus rectum; hereafter separation), <span class="math notranslate nohighlight">\(e\)</span> (eccentricity), and <span class="math notranslate nohighlight">\(\cos{I} \equiv x_I\)</span> (cosine of the angle <span class="math notranslate nohighlight">\(I\)</span> which describes the orbit’s inclination from the equatorial plane). The rate of change of <span class="math notranslate nohighlight">\(p,e,x_I\)</span> (left hand side of the first 3 equations) is obtained using the orbital-element fluxes <span class="math notranslate nohighlight">\(f_{p,e,x_I}\)</span>, which account for the gravitational wave emission, and the mass ratio <span class="math notranslate nohighlight">\(\epsilon = \mu/M\)</span>. For <span class="math notranslate nohighlight">\(\epsilon \rightarrow 0\)</span> we reach the test-particle limit, and the orbital elements do not vay over time. The extra contributions due to second order in the mass-ratio squared arise from the second-order self force, which is currently a very active field of research. For more information, see <a class="reference external" href="https://arxiv.org/abs/1805.10385">Barack and Pound</a>.</p></li>
</ol>
<ol class="arabic simple" start="2">
<li><p>The amplitude <span class="math notranslate nohighlight">\(A_{lmkn}(t)\)</span> which quantifies the size of each harmonic <span class="math notranslate nohighlight">\((l,m,k,n)\)</span>. These are determined using the orbital parameters <span class="math notranslate nohighlight">\(A_{lmkn}(p(t), e(t), x_I(t))\)</span>. See in the plot below that orbits with higher eccentricity <span class="math notranslate nohighlight">\(e_{0} = 0.7\)</span> require significantly many more harmonics than orbits with lower eccentricity <span class="math notranslate nohighlight">\(e_{0} = 0.1\)</span>. In each plot, the semi-latus rectum has been fixed to <span class="math notranslate nohighlight">\(p_{0} = 10\)</span> and <span class="math notranslate nohighlight">\(x_{I} = \cos(\iota_{0}) = 0.5\)</span>.</p></li>
</ol>
<p><img alt="amplitude.pdf" src="amplitude.pdf" /></p>
<ol class="arabic simple" start="3">
<li><p>The angular function <span class="math notranslate nohighlight">\(S_{lmkn}(\theta,\phi)\)</span> which describes how the amplitude is modulated depending on the source-frame polar viewing angle <span class="math notranslate nohighlight">\(\theta\)</span>, the source-frame azimuthal viewing angle <span class="math notranslate nohighlight">\(\phi\)</span>. For Schwarzchild black holes these functions reduce to the -2 spin weighted spherical harmonics <span class="math notranslate nohighlight">\(Y_{lm}\)</span>.</p></li>
</ol>
</section>
<section id="general-remarks">
<h3>General Remarks<a class="headerlink" href="#general-remarks" title="Permalink to this heading">#</a></h3>
<p>Notice the correspondence of the mode index with the three different degrees of freedom: <span class="math notranslate nohighlight">\(m\rightarrow \varphi\)</span> (azimuthal), <span class="math notranslate nohighlight">\(k\rightarrow \theta\)</span> (polar), <span class="math notranslate nohighlight">\(n\rightarrow r\)</span> (radial). Each mode (or harmonic) is characterized by the mode frequency <span class="math notranslate nohighlight">\(\omega_{mkn}=m\Omega_\varphi + k \Omega_\theta + n \Omega_r\)</span> which is the derivative of the phase <span class="math notranslate nohighlight">\(\Phi_{mkn}\)</span>. On short time-scales, the gravitational wave of an EMRI can be thought as a Fourier series with coefficients <span class="math notranslate nohighlight">\(\sum_l A_{lmnk} S_{lmkn}\)</span> and frequencies <span class="math notranslate nohighlight">\(\omega_{mkn}\)</span>.</p>
<p>Theoretical parameter ranges:</p>
<ul class="simple">
<li><p>the eccentricity ranges between 0 and 1, for <span class="math notranslate nohighlight">\(e=0\)</span> the orbits are circular;</p></li>
<li><p>the inclination parameter ranges between -1 and 1, for <span class="math notranslate nohighlight">\(x_I=1\)</span> the orbits are equatorial prograde, <span class="math notranslate nohighlight">\(x_I=-1\)</span> the orbits are equatorial retrograde, <span class="math notranslate nohighlight">\(x_I=0\)</span> the orbits are polar. An orbit is pro(retro)grade only if the trajectory of the body is (anti)aligned with the massive compact objects orbital angular momentum.</p></li>
<li><p>the dimensionless spin parameters ranges between 0 and 1, for <span class="math notranslate nohighlight">\(a=0\)</span> the central MBH is not spinning (Schwarzchild background) and the orbit of the compact object stays in the same plane, i.e. <span class="math notranslate nohighlight">\(x_I\)</span> is constant.</p></li>
</ul>
<p>See <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2021PhRvD.103j4014H/abstract">Hughes+ 2021</a> for further discussion and more detailed definitions.</p>
</section>
</section>
<section id="emri-parameter-space">
<h2>EMRI Parameter space<a class="headerlink" href="#emri-parameter-space" title="Permalink to this heading">#</a></h2>
<p>After we outlined the building blocks to create an EMRI waveform, let us now understand how these are organized in the Fast EMRI Waveform code. The waveform code takes as input two sets of parameters:</p>
<ul class="simple">
<li><p>the intrinsic parameters <span class="math notranslate nohighlight">\((M,\mu,a,p_0,e_0,(x_{I})_0,\Phi_{\varphi 0},\Phi_{\theta 0},\Phi_{r 0})\)</span>, which are used to construct the waveform in the source frame; Notice that the last six parameters here serve as initial conditions for the coupled set of ODEs defined earlier, with <span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span> determining the most crucial feature of the EMRI: The mass ratio <span class="math notranslate nohighlight">\(\epsilon = \mu/M\)</span>. The intrinsic parameters govern the evolution of the signal as a function of frequency.</p></li>
<li><p>the extrinsic parameters <span class="math notranslate nohighlight">\((d_L,\theta_S,\phi_S,\theta_K,\phi_K)\)</span>, which define how the waveform is viewed in a given reference frame. The extrinsic parameters feature more in the amplitude of the waveform.</p></li>
</ul>
<p>The intrinsic parameters are then passed into the trajectory module which computes the sparse time evolution of the phases <span class="math notranslate nohighlight">\(\Phi_{\varphi}(t),\Phi_{\theta}(t),\Phi_{r}(t)\)</span> and orbital elements <span class="math notranslate nohighlight">\(p(t),e(t),x_I(t)\)</span>. The phases are used to assemble the oscillatory part, whereas the orbital elements are passed to the amplitude module which computes <span class="math notranslate nohighlight">\(A(p(t),e(t),x_I(t))\)</span>. The angular function is computed using the extrinsic parameters. Then the summation module (Waveform build) takes as input the functions <span class="math notranslate nohighlight">\(\exp[-i\Phi_{mkn}(t)], A_{lmkn}(t)\)</span> and <span class="math notranslate nohighlight">\(S_{lmkn}(\theta,\phi)\)</span> and outputs the waveform strain <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p><img alt="FEW_arch.pdf" src="FEW_arch.pdf" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we import here all the modules and packages we need</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">few.trajectory.inspiral</span> <span class="kn">import</span> <span class="n">EMRIInspiral</span>
<span class="kn">from</span> <span class="nn">few.amplitude.romannet</span> <span class="kn">import</span> <span class="n">RomanAmplitude</span>
<span class="kn">from</span> <span class="nn">few.amplitude.interp2dcubicspline</span> <span class="kn">import</span> <span class="n">Interp2DAmplitude</span>
<span class="kn">from</span> <span class="nn">few.waveform</span> <span class="kn">import</span> <span class="n">FastSchwarzschildEccentricFlux</span><span class="p">,</span> <span class="n">SlowSchwarzschildEccentricFlux</span><span class="p">,</span> <span class="n">GenerateEMRIWaveform</span>
<span class="kn">from</span> <span class="nn">few.utils.utility</span> <span class="kn">import</span> <span class="p">(</span><span class="n">get_overlap</span><span class="p">,</span> 
                               <span class="n">get_mismatch</span><span class="p">,</span> 
                               <span class="n">get_fundamental_frequencies</span><span class="p">,</span> 
                               <span class="n">get_separatrix</span><span class="p">,</span> 
                               <span class="n">get_mu_at_t</span><span class="p">,</span> 
                               <span class="n">get_p_at_t</span><span class="p">,</span> 
                               <span class="n">get_kerr_geo_constants_of_motion</span><span class="p">,</span>
                               <span class="n">xI_to_Y</span><span class="p">,</span>
                               <span class="n">Y_to_xI</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">few.utils.ylm</span> <span class="kn">import</span> <span class="n">GetYlms</span>
<span class="kn">from</span> <span class="nn">few.utils.modeselector</span> <span class="kn">import</span> <span class="n">ModeSelector</span>
<span class="kn">from</span> <span class="nn">few.summation.interpolatedmodesum</span> <span class="kn">import</span> <span class="n">CubicSplineInterpolant</span>
<span class="kn">from</span> <span class="nn">few.waveform</span> <span class="kn">import</span> <span class="n">SchwarzschildEccentricWaveformBase</span>
<span class="kn">from</span> <span class="nn">few.summation.interpolatedmodesum</span> <span class="kn">import</span> <span class="n">InterpolatedModeSum</span>
<span class="kn">from</span> <span class="nn">few.summation.directmodesum</span> <span class="kn">import</span> <span class="n">DirectModeSum</span>
<span class="kn">from</span> <span class="nn">few.utils.constants</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">few.summation.aakwave</span> <span class="kn">import</span> <span class="n">AAKSummation</span>
<span class="kn">from</span> <span class="nn">few.waveform</span> <span class="kn">import</span> <span class="n">Pn5AAKWaveform</span><span class="p">,</span> <span class="n">AAKWaveformBase</span>

<span class="n">use_gpu</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># keyword arguments for inspiral generator (RunSchwarzEccFluxInspiral)</span>
<span class="n">inspiral_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;DENSE_STEPPING&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># we want a sparsely sampled trajectory</span>
        <span class="s2">&quot;max_init_len&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e3</span><span class="p">),</span>  <span class="c1"># all of the trajectories will be well under len = 1000</span>
    <span class="p">}</span>

<span class="c1"># keyword arguments for inspiral generator (RomanAmplitude)</span>
<span class="n">amplitude_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;max_init_len&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e3</span><span class="p">),</span>  <span class="c1"># all of the trajectories will be well under len = 1000</span>
    <span class="s2">&quot;use_gpu&quot;</span><span class="p">:</span> <span class="n">use_gpu</span>  <span class="c1"># GPU is available in this class</span>
<span class="p">}</span>

<span class="c1"># keyword arguments for Ylm generator (GetYlms)</span>
<span class="n">Ylm_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;assume_positive_m&quot;</span><span class="p">:</span> <span class="kc">False</span>  <span class="c1"># if we assume positive m, it will generate negative m for all m&gt;0</span>
<span class="p">}</span>

<span class="c1"># keyword arguments for summation generator (InterpolatedModeSum)</span>
<span class="n">sum_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;use_gpu&quot;</span><span class="p">:</span> <span class="n">use_gpu</span><span class="p">,</span>  <span class="c1"># GPU is availabel for this type of summation</span>
    <span class="s2">&quot;pad_output&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="schwarzschild-eccentric-waveforms">
<h2>Schwarzschild Eccentric Waveforms<a class="headerlink" href="#schwarzschild-eccentric-waveforms" title="Permalink to this heading">#</a></h2>
<p>In this tutorial we will restrict to EMRI systems in which the central object is a non-spinning black hole. The case of a spinning black hole is presented at the end of the notebook in the additional materials.</p>
</section>
<section id="trajectory-module">
<h2>Trajectory Module<a class="headerlink" href="#trajectory-module" title="Permalink to this heading">#</a></h2>
<p>The trajectory module generates orbital <span class="math notranslate nohighlight">\(\{p(t),e(t), x_{I}(t)\}\)</span> and phase <span class="math notranslate nohighlight">\(\{\Phi_\varphi(t), \Phi_\theta(t), \Phi_r(t)\}\)</span> trajectories for an EMRI orbit defined by the coordinate-time evolving quantities:</p>
<p>\begin{equation}
p(t), e(t), x_I(t), \Phi_\varphi(t), \Phi_\theta(t), \Phi_r(t)
\end{equation}</p>
<p>with initial inputs <span class="math notranslate nohighlight">\(M, \mu, p_0, e_0, \iota_0, \Phi_{\varphi0}, \Phi_{\theta0}, \Phi_{r 0}\)</span>. The trajectory is evolved for a user defined time of <span class="math notranslate nohighlight">\(T\)</span> years or until the last-stable orbit, defined by the separatrix <span class="math notranslate nohighlight">\(p_{sep}\)</span> is reached. If the specified duration <span class="math notranslate nohighlight">\(T\)</span> is longer than the time taken to reach the separatrix, then the orbit will terminate at <span class="math notranslate nohighlight">\(p(t_{\text{sep}}) = p_{\text{sep}}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(M\)</span> is the larger mass (<span class="math notranslate nohighlight">\(M_\odot\)</span>), <span class="math notranslate nohighlight">\(\mu\)</span> is the compact object mass (<span class="math notranslate nohighlight">\(M_\odot\)</span>), <span class="math notranslate nohighlight">\(p_0\)</span> is the initial semi-latus rectum (dimensionless), <span class="math notranslate nohighlight">\(e_0\)</span> is the initial eccentricity (dimensionless), and the final three are the initial orbital phases <span class="math notranslate nohighlight">\(\Phi_{\varphi 0}, \Phi_{\theta 0}, \Phi_{r 0}\)</span> (in radians). The three orbital phases can be thought of as “positional elements” of the smaller body when in orbit of the primary black hole. Take, for example, a sphere of radius <span class="math notranslate nohighlight">\(r\)</span>. There are infinitely many points on that sphere for where that radius could be defined. However, only by fixing the angular variables in <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> can you define a specific point on a sphere with spherical polar coordinates <span class="math notranslate nohighlight">\((r,\theta,\phi)\)</span>. It’s similar for the EMRI orbit. If you specify a specific orbital parameters <span class="math notranslate nohighlight">\(p_{0},e_{0},(x_{I})_{0}\)</span> then we need phase variables <span class="math notranslate nohighlight">\(\Phi_{\varphi 0,\theta 0,\phi 0}\)</span> to determine the smaller bodies position with respect to the central massive black hole.</p>
<p>For the special case of non-rotating black holes (Schwarzchild black holes) the spin parameter is zero <span class="math notranslate nohighlight">\(a=0\)</span>. This will simplify the orbit where the body necessarily remains on the same plane <span class="math notranslate nohighlight">\(x_I=1\)</span>, and the separatrix is located at <span class="math notranslate nohighlight">\(p_\textrm{sep} = 6+2e\)</span>. Given that <span class="math notranslate nohighlight">\(p(t)\)</span> and <span class="math notranslate nohighlight">\(e(t)\)</span> are time-evolving quantities, the separatrix will also be evolving in time. For further details on the location of the separatrix for generic orbits around rotating black holes (and various special cases), see <a class="reference external" href="https://arxiv.org/pdf/1912.07609.pdf">Stein and Warburton</a> for an excellent discussion.</p>
<section id="let-us-being-by-analysing-a-basic-trajectory">
<h3>Let us being by analysing a basic trajectory<a class="headerlink" href="#let-us-being-by-analysing-a-basic-trajectory" title="Permalink to this heading">#</a></h3>
<p>We begin by analysing eccentric orbits in a Schwarzschild space-time. This means that <span class="math notranslate nohighlight">\(a = 0, x_{I}(t) = 1, \Phi_{r0}(t) = \Phi_{\theta0} = 0\)</span> will be fixed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize trajectory class</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;SchwarzEccFlux&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters for Schwarzschild orbit</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>   <span class="c1"># Primary mass  (solar masses)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>  <span class="c1"># Secondary mass  (solar masses)</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># additional information </span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="c1"># initial time step, </span>
              <span class="n">T</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="c1"># Time duration in years</span>
              <span class="n">err</span><span class="o">=</span><span class="mf">1e-10</span> <span class="c1"># integrator error -- used as a tolerance to solve coupled ODEs above</span>
             <span class="p">)</span>

<span class="c1"># Compute trajectory of smaller body: p(t), e(t), xI(t), Phi_phi(t), Phi_theta(t), Phi_r(t)</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">xI</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                              <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="c1"># get dimensionless fundamental frequencies</span>
<span class="n">OmegaPhi</span><span class="p">,</span> <span class="n">OmegaTheta</span><span class="p">,</span> <span class="n">OmegaR</span> <span class="o">=</span> <span class="n">get_fundamental_frequencies</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>


<span class="c1"># Plot the results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_\phi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_r$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Omega_\phi$&#39;</span><span class="p">]</span>
<span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$ [years]&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$ [years]&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$ [years]&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$ [years]&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$ [years]&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$ [years]&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$ [years]&#39;</span><span class="p">]</span>
<span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">OmegaPhi</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">,</span> <span class="n">t</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">,</span> <span class="n">t</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">,</span> <span class="n">t</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">,</span> <span class="n">t</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xlab</span><span class="p">,</span> <span class="n">ylab</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/52e5b6a5b3c258f347ee3617ffb87969fb25e2148b441fd4071ebf97aa3ab028.png" src="_images/52e5b6a5b3c258f347ee3617ffb87969fb25e2148b441fd4071ebf97aa3ab028.png" />
</div>
</div>
</section>
</section>
<section id="exercise-0">
<h2>Exercise 0<a class="headerlink" href="#exercise-0" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>For the default parameters <span class="math notranslate nohighlight">\((M,\mu,a,p_{0},e_{0},(x_{I})_{0}) = (10^{6}, 10, 0, 10, 0.3, 1)\)</span> with <span class="math notranslate nohighlight">\(T = 2\)</span> years, verify that the final point in semi-latus rectum corresponds to the separatrix defined by <span class="math notranslate nohighlight">\(p = 6 + 2e\)</span>. Change the time of evolution <span class="math notranslate nohighlight">\(T\)</span> and make a note of what you find.</p></li>
<li><p>Modify the mass-ratio of the system above by increasing/decreasing <span class="math notranslate nohighlight">\(M\)</span> whilst keeping <span class="math notranslate nohighlight">\(\mu\)</span> (and all other parameters) fixed. What do you observe about the orbital evolution in semi-latus rectum <span class="math notranslate nohighlight">\(p(t)\)</span>? You may need to increase the time of evolution <span class="math notranslate nohighlight">\(T\)</span>. You will find that <span class="math notranslate nohighlight">\(\dot{p} = dp/dt\)</span> decreases as <span class="math notranslate nohighlight">\(M\)</span> is increased.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># EXERCISE 0! </span>

<span class="c1"># set initial parameters for Schwarzschild orbit</span>
<span class="c1"># M = 1e6   # Primary mass  (solar masses)</span>
<span class="c1"># mu = 1e1  # Secondary mass  (solar masses)</span>
<span class="c1"># p0 = 10.0 # range [separatrix, 45]</span>
<span class="c1"># e0 = 0.3  # range [0.0, 0.7]</span>

<span class="c1"># # run trajectory</span>
<span class="c1"># # must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="c1"># a = 0.0</span>
<span class="c1"># x = 1.0</span>

<span class="c1"># # additional information </span>
<span class="c1"># kwargs = dict(dt=10.0, # initial time step, </span>
<span class="c1">#               T=2.0, # Time duration in years</span>
<span class="c1">#               err=1e-10 # integrator error -- used as a tolerance to solve coupled ODEs above</span>
<span class="c1">#              )</span>

<span class="c1"># # Compute trajectory of smaller body: p(t), e(t), xI(t), Phi_phi(t), Phi_theta(t), Phi_r(t)</span>
<span class="c1"># t, p, e, xI, Phi_phi, Phi_theta, Phi_r = traj(M, mu, a, p0, e0, x,</span>
<span class="c1">#                                               Phi_phi0=0.0,</span>
<span class="c1">#                                               Phi_theta0=0.0,</span>
<span class="c1">#                                               Phi_r0=0.0,</span>
<span class="c1">#                                               **kwargs)</span>

<span class="c1"># p_sep = [INSERT YOUR CODE HERE] </span>
<span class="c1"># print(&quot;Separatrix is at &quot;,p_sep)</span>
<span class="c1"># print(&quot;Final point in semi-latus rectum is&quot;, p[-1])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># EXERCISE 0! </span>

<span class="c1"># set initial parameters for Schwarzschild orbit</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>  <span class="c1"># Secondary mass  (solar masses)</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># additional information </span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="c1"># initial time step, </span>
              <span class="n">T</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="c1"># Time duration in years</span>
              <span class="n">err</span><span class="o">=</span><span class="mf">1e-10</span> <span class="c1"># integrator error -- used as a tolerance to solve coupled ODEs above</span>
             <span class="p">)</span>

<span class="c1"># Compute trajectory of smaller body: p(t), e(t), xI(t), Phi_phi(t), Phi_theta(t), Phi_r(t)</span>

<span class="n">M_vec</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">N_plots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">M_vec</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N_plots</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">M_vec</span><span class="p">:</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">xI</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                                  <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">60</span><span class="o">/</span><span class="mi">60</span><span class="o">/</span><span class="mi">24</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;M = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;time [days]&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;semi-latus rectum $p$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Primary mass = </span><span class="si">{}</span><span class="s1"> $M_\odot$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">M</span><span class="p">),</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    

    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># p_sep = [INSERT YOUR CODE HERE] </span>
<span class="c1"># print(&quot;Separatrix is at &quot;,p_sep)</span>
<span class="c1"># print(&quot;Final point in semi-latus rectum is&quot;, p[-1])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/447ff4e03604870c4b8721868380b0b2558cc3161fd33841a1b6e71b9fd35afc.png" src="_images/447ff4e03604870c4b8721868380b0b2558cc3161fd33841a1b6e71b9fd35afc.png" />
</div>
</div>
<section id="quasi-keplerian-parameters-p-e">
<h3>Quasi-Keplerian parameters: <span class="math notranslate nohighlight">\((p,e)\)</span><a class="headerlink" href="#quasi-keplerian-parameters-p-e" title="Permalink to this heading">#</a></h3>
<p>We want to remark that <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(e\)</span> are quasi-Keplerian parameters and gauge dependent quantities (they depend on the choice of coordinate system). They “converge” to the Newtonian equivalent parameters in the weak field regime (far away in radial coordinate <span class="math notranslate nohighlight">\(r\)</span> from the black hole). Below we show a plot of ellipsis based on these parameters at diferent stages of the evolution. This is useful to get a sense of the evolution of the orbit but you should not interpret these ellipsis as real orbits!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;Spectral&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
    <span class="n">ee</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
    <span class="n">Csi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="n">pp</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">ee</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Csi</span><span class="p">))</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">rr</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Csi</span><span class="p">)</span>
    <span class="n">yy</span> <span class="o">=</span> <span class="n">rr</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Csi</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">ii</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)),</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;time = </span><span class="si">{</span><span class="n">t</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">YRSID_SI</span><span class="p">)</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> years&#39;</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;MBH&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r\cos(\xi)$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r\sin(\xi)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Illustrative depiction of orbits&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b9eb33ef18f27a931c0f77018f032fd306a2c1d7ffc8420c2273845a55f32a81.png" src="_images/b9eb33ef18f27a931c0f77018f032fd306a2c1d7ffc8420c2273845a55f32a81.png" />
</div>
</div>
</section>
</section>
<section id="evolution-of-semi-latus-rectum-and-eccentricity">
<h2>Evolution of semi-latus rectum and eccentricity<a class="headerlink" href="#evolution-of-semi-latus-rectum-and-eccentricity" title="Permalink to this heading">#</a></h2>
<p>The goal of the next cell is to understand how the semi-latus rectum and eccentricity evolve together. Notice that for trajectories with semi-latus rectum close to the separatrix, one observes an “uptick” in the eccentricity. This is a well known feature and is further discussed in this <a class="reference external" href="https://arxiv.org/abs/gr-qc/0203086">article</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>     <span class="c1"># Primary mass (solar masses)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>    <span class="c1"># Secondary mass (solar masses)</span>

<span class="c1"># run trajectory</span>

<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># additional information </span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="c1"># initial time step, </span>
              <span class="n">T</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="c1"># Time duration in years [Excessive, but want to evolve to separatrix! here]</span>
              <span class="n">err</span><span class="o">=</span><span class="mf">1e-10</span> <span class="c1"># integrator error</span>
             <span class="p">)</span>

<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>


<span class="c1"># Here we plot the trajectory with all parameters fixed (e0 = 0.7) apart from p0</span>
<span class="k">for</span> <span class="n">p0</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">e0</span><span class="o">=</span><span class="mf">0.7</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">xI</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                              <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>

<span class="c1"># Now we plot the trajectory with all parameters fixed (p0 = 20) apart from e0</span>
<span class="k">for</span> <span class="n">e0</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.69</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">p0</span><span class="o">=</span><span class="mf">20.0</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">xI</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                              <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>

<span class="c1"># Separatrix given by p_sep = 6 + 2*e</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mf">7.5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ecc</span> <span class="o">=</span> <span class="p">(</span><span class="n">pp</span> <span class="o">-</span> <span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">ecc</span><span class="p">,</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;separatrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02a4af2defb2a276b1d56884fc81234bb4e4662f42467e9ac659213b047a7a08.png" src="_images/02a4af2defb2a276b1d56884fc81234bb4e4662f42467e9ac659213b047a7a08.png" />
</div>
</div>
<section id="trajectory-duration-as-a-function-of-mass-ratio-eccentricity-semi-latus-rectum">
<h3>Trajectory duration as a function of mass ratio, eccentricity, semi-latus rectum<a class="headerlink" href="#trajectory-duration-as-a-function-of-mass-ratio-eccentricity-semi-latus-rectum" title="Permalink to this heading">#</a></h3>
<p>In Exercise 0 above we saw that the length of the trajectory, in time, is very sensitive to the mass-ratio of the system. The coupled ODEs
\begin{align}
\frac{d}{dt}p &amp;= \epsilon , f^{(1)}_p(a, p, e, x_I) + \mathcal{O}(\epsilon^2)\
\frac{d}{dt}e &amp;= \epsilon , f^{(1)}_e(a, p, e, x_I) + \mathcal{O}(\epsilon^2)\
\end{align}
show that <span class="math notranslate nohighlight">\(\dot{p} \sim \dot{e} \sim \epsilon\)</span>. It should then be expected that the rate of change of the orbital parameters <span class="math notranslate nohighlight">\(p(t)\)</span> and <span class="math notranslate nohighlight">\(e(t)\)</span> is directly proportional to the size of the mass-ratio of the system. We will investigate this below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>   <span class="c1"># Primary mass</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>  <span class="c1"># Secondary mass</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mi">12</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># run trajectory</span>

<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="c1"># Fix time duration to a very large number (1000 years) so that we obtain the time duration from trajectory</span>

<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="c1"># initial time setp, </span>
              <span class="n">T</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span>
              <span class="n">err</span><span class="o">=</span><span class="mf">1e-10</span> <span class="c1"># integrator error</span>
             <span class="p">)</span>

<span class="n">mass_ratio_vector</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.0</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">tfinal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">count</span><span class="p">,</span><span class="n">epsilon</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mass_ratio_vector</span><span class="p">):</span>

    <span class="c1"># get secondary mass for fixed mass ratio</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="n">epsilon</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">xI</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                                  <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="c1"># inspiral duration (divide by YRSID_SI to get it in years)</span>
    <span class="n">tfinal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">)</span> 
    <span class="k">if</span> <span class="n">count</span><span class="o">%</span><span class="k">3</span> == 0:
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For a mass-ratio of epsilon = </span><span class="si">{}</span><span class="s2">, time duration is T = </span><span class="si">{}</span><span class="s2"> years&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For a mass-ratio of epsilon = 0.0001, time duration is T = 0.3967452628006567 years
For a mass-ratio of epsilon = 1e-05, time duration is T = 3.967452550970718 years
For a mass-ratio of epsilon = 1e-06, time duration is T = 39.6745203486156 years
For a mass-ratio of epsilon = 1e-07, time duration is T = 396.74518326623223 years
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">mass_ratio_vector</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="s2">&quot;16&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Time duration [years]&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass ratio&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/157bc94a7514a75040287f7bf1e7e0bb26ecc143c8642ca05a4379fcaaf21a0b.png" src="_images/157bc94a7514a75040287f7bf1e7e0bb26ecc143c8642ca05a4379fcaaf21a0b.png" />
</div>
</div>
</section>
<section id="discussion-of-plot-above">
<h3>Discussion of plot above<a class="headerlink" href="#discussion-of-plot-above" title="Permalink to this heading">#</a></h3>
<p>In each trajectory calculation, the initial semi-latus rectum is fixed. The only quantity that is changing is the mass ratio <span class="math notranslate nohighlight">\(\epsilon = \mu/M\)</span>. As <span class="math notranslate nohighlight">\(\epsilon\)</span> decreases, the trajectory evolution time increases. The time of evolut ion is thus inversely proportional to the mass-ratio of the system. We thus see that</p>
<p>\begin{equation}
T_{\text{observation}} \sim 1/\epsilon
\end{equation}</p>
<p>Notice that for <span class="math notranslate nohighlight">\(\epsilon = 10^{-7}\)</span>, with the parameters given above, it would have taken 396 years to plunge. Whereas with a mass-ratio of <span class="math notranslate nohighlight">\(\epsilon = 10^{-4}\)</span>, it would have only taken 144 days.</p>
<p>Cool.</p>
</section>
</section>
<section id="exercise-1">
<h2>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this heading">#</a></h2>
<p>Let us now understand how the inspiral duration changes for different initial eccentricity or different initial semi-latus rectum. Remember the range of validity of the parameters and produce two plots:</p>
<ol class="arabic simple">
<li><p>Time duration vs initial eccentricity (fixing all the other parameters)</p></li>
<li><p>Time duration vs initial semi-latus rectum (fixing all the other parameters)</p></li>
</ol>
<p>If you have time, produce also this plot:</p>
<ol class="arabic simple" start="3">
<li><p>Time duration vs M/epsilon (M=Mass MBHS and epsilon=Mass ratio). Prove that, for different total masses and mass ratios, the behavior of Time duration vs M/epsilon is always the same (Hint: use two for loops, one for <span class="math notranslate nohighlight">\(M\)</span> and the other for <span class="math notranslate nohighlight">\(\epsilon\)</span>).</p></li>
</ol>
<p>You should find that:</p>
<ol class="arabic simple">
<li><p>The relation between time-duration and eccentricity is weak</p></li>
<li><p>The relation between time-duration and semi-latus rectum is near-linear</p></li>
<li><p>The relation between time-duration and <span class="math notranslate nohighlight">\(M/\epsilon\)</span> is perfectly linear.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time duration vs initial eccentricity -- It&#39;s your turn! </span>

<span class="c1">## # set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="c1"># Fix time duration to a very large number (100 years) so that we obtain the time duration from trajectory</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="c1"># initial time setp, </span>
              <span class="n">T</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span>
              <span class="n">err</span><span class="o">=</span><span class="mf">1e-10</span> <span class="c1"># integrator error</span>
             <span class="p">)</span>

<span class="c1"># ecc = np.linspace(0.01, 0.7, num=10)</span>

<span class="c1"># tfinal = []</span>
<span class="c1"># for e0 in ecc:</span>

<span class="c1">#  [INPUT YOUR CODE IN HERE]</span>
    
<span class="c1">#     tfinal.append(t[-1]/YRSID_SI) </span>


<span class="c1"># plt.figure()</span>
<span class="c1"># plt.plot(ecc, tfinal) </span>
<span class="c1"># plt.ylabel(&#39;Time duration [years]&#39;)</span>
<span class="c1"># plt.xlabel(&#39;e0&#39;)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time duration vs initial semi-latus rectum</span>

<span class="c1">## # set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="c1"># Fix time duration to a very large number (100 years) so that we obtain the time duration from trajectory</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="c1"># initial time setp, </span>
              <span class="n">T</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span>
              <span class="n">err</span><span class="o">=</span><span class="mf">1e-10</span> <span class="c1"># integrator error</span>
             <span class="p">)</span>

<span class="c1"># tfinal = []</span>
<span class="c1"># e0 = 0.0 # reset eccentricity</span>
<span class="c1"># pp = np.linspace(7.0, 30.0, num=10)</span>
<span class="c1"># for p0 in pp:</span>

<span class="c1">#  [INPUT YOUR CODE IN HERE]</span>

<span class="c1">#     tfinal.append(t[-1]/YRSID_SI) </span>


<span class="c1"># plt.figure()</span>
<span class="c1"># plt.loglog(pp, tfinal) </span>
<span class="c1"># plt.ylabel(&#39;Time duration [years]&#39;)</span>
<span class="c1"># plt.xlabel(&#39;p0&#39;)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## # set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="c1"># Fix time duration to a very large number (100 years) so that we obtain the time duration from trajectory</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="c1"># initial time setp, </span>
              <span class="n">T</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span>
              <span class="n">err</span><span class="o">=</span><span class="mf">1e-10</span> <span class="c1"># integrator error</span>
             <span class="p">)</span>

<span class="c1"># tfinal = []</span>
<span class="c1"># e0 = 0.2 # reset</span>
<span class="c1"># p0=10.0</span>

<span class="c1"># epsilon_vector = 10**np.linspace(-4.0, -6.0, num=10)</span>
<span class="c1"># Mvec = 10**np.linspace(4.0, 7.0, num=10)</span>

<span class="c1"># plt.figure()</span>
<span class="c1"># for M in [CODE HERE]:</span>
<span class="c1">#     tfinal = []</span>
<span class="c1">#     for epsilon in [CODE HERE]:</span>

<span class="c1">#         # get secondary mass for fixed mass ratio</span>
        
<span class="c1">#         mu = [CODE HERE]</span>
<span class="c1">#         CODE HERE -- Generate your trajectory for given choices of M and epsilon. </span>

<span class="c1">#         # inspiral duration (divide by YRSID_SI to get it in years)</span>
<span class="c1">#         tfinal.append(t[-1]/YRSID_SI) </span>

    <span class="c1"># plt.plot(M/epsilon_vector, tfinal) </span>
<span class="c1"># plt.ylabel(&#39;Time duration [years]&#39;)</span>
<span class="c1"># plt.xlabel(&#39;$M/\epsilon$&#39;)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
<section id="number-of-cycles-and-differences-between-trajectories">
<h3>Number of cycles and differences between trajectories<a class="headerlink" href="#number-of-cycles-and-differences-between-trajectories" title="Permalink to this heading">#</a></h3>
<p>It is often common to introduce the number of cycles <span class="math notranslate nohighlight">\(\mathcal{N}_\varphi (t)= \Phi_\varphi(t)/(2\pi)\)</span> to quantify the number of times the compact object orbits around the MBH. This is useful to quantify the difference between trajectories.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># set initial parameters</span>
<span class="n">M1</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu1</span> <span class="o">=</span> <span class="mf">1e1</span>

<span class="n">t1</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">xI1</span><span class="p">,</span> <span class="n">Phi_phi1</span><span class="p">,</span> <span class="n">Phi_theta1</span><span class="p">,</span> <span class="n">Phi_r1</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="n">mu1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                              <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">M2</span> <span class="o">=</span> <span class="mf">5e5</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t2</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">xI2</span><span class="p">,</span> <span class="n">Phi_phi2</span><span class="p">,</span> <span class="n">Phi_theta2</span><span class="p">,</span> <span class="n">Phi_r2</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                              <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">,</span><span class="n">Phi_phi1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;mu=</span><span class="si">{</span><span class="n">mu1</span><span class="si">}</span><span class="s1">, M=</span><span class="si">{</span><span class="n">M1</span><span class="o">/</span><span class="mf">1e6</span><span class="si">}</span><span class="s1"> x $10^6$, $\epsilon$ = </span><span class="si">{</span><span class="n">mu1</span><span class="o">/</span><span class="n">M1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">,</span><span class="n">Phi_phi2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;mu=</span><span class="si">{</span><span class="n">mu2</span><span class="si">}</span><span class="s1">, M=</span><span class="si">{</span><span class="n">M2</span><span class="o">/</span><span class="mf">1e6</span><span class="si">}</span><span class="s1"> x $10^6$, $\epsilon$ = </span><span class="si">{</span><span class="n">mu2</span><span class="o">/</span><span class="n">M2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of cycles&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [years]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final number of cycles of system 1 with mu = </span><span class="si">{}</span><span class="s2"> and M = </span><span class="si">{}</span><span class="s2"> is N_cyles = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mu1</span><span class="p">,</span><span class="n">M1</span><span class="p">,</span><span class="n">Phi_phi1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final number of cycles of system 2 with mu = </span><span class="si">{}</span><span class="s2"> and M = </span><span class="si">{}</span><span class="s2"> is N_cycles = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span><span class="n">M2</span><span class="p">,</span><span class="n">Phi_phi2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/616a6b224da7f0ff2435e56715a87325d4e16ff0d02347abd3043f85ccee9012.png" src="_images/616a6b224da7f0ff2435e56715a87325d4e16ff0d02347abd3043f85ccee9012.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final number of cycles of system 1 with mu = 10.0 and M = 1000000.0 is N_cyles = 51298.48461545311
Final number of cycles of system 2 with mu = 5 and M = 500000.0 is N_cycles = 51298.48113547578
</pre></div>
</div>
</div>
</div>
<p>The two systems have the same mass ratio and the same final number of cycles. However, the number of cycles accumulated per second is different. An EMRI system with larger MBH “more slowly” than a system with smaller <code class="docutils literal notranslate"><span class="pre">M</span></code>.  Notice that the frequencies are related to the time derivative of the number of cycles
$<span class="math notranslate nohighlight">\(
\frac{d}{dt} \mathcal{N}_\varphi = \frac{1}{2 \pi}\frac{d}{dt} \Phi_\varphi = \frac{1}{2 \pi} \Omega_\varphi
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># set initial parameters</span>
<span class="n">M1</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu1</span> <span class="o">=</span> <span class="mf">1e1</span>

<span class="n">epsilon</span> <span class="o">=</span> <span class="n">mu</span><span class="o">/</span><span class="n">M</span>



<span class="n">t1</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">xI1</span><span class="p">,</span> <span class="n">Phi_phi1</span><span class="p">,</span> <span class="n">Phi_theta1</span><span class="p">,</span> <span class="n">Phi_r1</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="n">mu1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                              <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">OmegaPhi1</span><span class="p">,</span> <span class="n">OmegaTheta1</span><span class="p">,</span> <span class="n">OmegaR1</span> <span class="o">=</span> <span class="n">get_fundamental_frequencies</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">xI1</span><span class="p">)</span>

<span class="n">M2</span> <span class="o">=</span> <span class="mf">5e5</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t2</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">xI2</span><span class="p">,</span> <span class="n">Phi_phi2</span><span class="p">,</span> <span class="n">Phi_theta2</span><span class="p">,</span> <span class="n">Phi_r2</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">xI1</span><span class="p">,</span>
                                              <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">OmegaPhi2</span><span class="p">,</span> <span class="n">OmegaTheta2</span><span class="p">,</span> <span class="n">OmegaR2</span> <span class="o">=</span> <span class="n">get_fundamental_frequencies</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">xI2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">,</span><span class="n">OmegaPhi1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;mu=</span><span class="si">{</span><span class="n">mu1</span><span class="si">}</span><span class="s1">, M=</span><span class="si">{</span><span class="n">M1</span><span class="o">/</span><span class="mf">1e6</span><span class="si">}</span><span class="s1"> x $10^6$, $\epsilon$ = </span><span class="si">{</span><span class="n">mu1</span><span class="o">/</span><span class="n">M1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">,</span><span class="n">OmegaPhi2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;mu=</span><span class="si">{</span><span class="n">mu2</span><span class="si">}</span><span class="s1">, M=</span><span class="si">{</span><span class="n">M2</span><span class="o">/</span><span class="mf">1e6</span><span class="si">}</span><span class="s1"> x $10^6$, $\epsilon$ = </span><span class="si">{</span><span class="n">mu2</span><span class="o">/</span><span class="n">M2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$dN_{\phi}/dt$&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [seconds]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7a935719b5a8441c8d7f2f22aa069e8955ee8f6c367e0edd51420db4c6b0d39e.png" src="_images/7a935719b5a8441c8d7f2f22aa069e8955ee8f6c367e0edd51420db4c6b0d39e.png" />
</div>
</div>
</section>
</section>
<section id="exercise-2">
<h2>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this heading">#</a></h2>
<p>Plot the FINAL number of cycles (<code class="docutils literal notranslate"><span class="pre">Ncycle.append(Phi_phi[-1]/(2*np.pi))</span></code>) for different mass ratios. What do you find? If you see a linear relationship then well done!!!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>

<span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># Ncycle = []</span>
<span class="c1"># for epsilon in epsilon_vector:</span>

<span class="c1">#     # get secondary mass for fixed mass ratio</span>
<span class="c1">#     mu = [CODE HERE]</span>
<span class="c1">#     t, p, e, xI, Phi_phi, Phi_theta, Phi_r = [CODE HERE]</span>
    
<span class="c1">#     Ncycle.append([CODE HERE]) </span>
    

<span class="c1"># plt.figure()</span>
<span class="c1"># plt.loglog(mass_ratio_vector, Ncycle) </span>
<span class="c1"># plt.ylabel(&#39;Number of cycles&#39;)</span>
<span class="c1"># plt.xlabel(&#39;Mass ratio&#39;)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
<section id="fundamental-frequencies-and-harmonics">
<h3>Fundamental frequencies and harmonics<a class="headerlink" href="#fundamental-frequencies-and-harmonics" title="Permalink to this heading">#</a></h3>
<p>An EMRI Waveform can thought as a Fourier series where the frequencies <span class="math notranslate nohighlight">\(\omega_{mnk}\)</span> are given by
$<span class="math notranslate nohighlight">\(
\omega_{mnk} = m \Omega_\varphi + n \Omega_r + k \Omega_\theta
\)</span>$
Therefore is possible to plot the frequency evolution of each harmonic given a trajectory. This can be useful to understand which frequency range each harmonic spans.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>

<span class="n">t1</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">xI1</span><span class="p">,</span> <span class="n">Phi_phi1</span><span class="p">,</span> <span class="n">Phi_theta1</span><span class="p">,</span> <span class="n">Phi_r1</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                              <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="c1"># get the fundamental frequencies</span>
<span class="n">OmegaPhi1</span><span class="p">,</span> <span class="n">OmegaTheta1</span><span class="p">,</span> <span class="n">OmegaR1</span> <span class="o">=</span> <span class="n">get_fundamental_frequencies</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">xI1</span><span class="p">)</span>

<span class="n">M2</span> <span class="o">=</span> <span class="mf">5e5</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t2</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">xI2</span><span class="p">,</span> <span class="n">Phi_phi2</span><span class="p">,</span> <span class="n">Phi_theta2</span><span class="p">,</span> <span class="n">Phi_r2</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                              <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">OmegaPhi2</span><span class="p">,</span> <span class="n">OmegaTheta2</span><span class="p">,</span> <span class="n">OmegaR2</span> <span class="o">=</span> <span class="n">get_fundamental_frequencies</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">xI2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># we need to divide by the total Mass and convert to seconds</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">OmegaPhi</span> <span class="o">/</span> <span class="p">(</span><span class="n">M1</span> <span class="o">*</span> <span class="n">MTSUN_SI</span><span class="p">)</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;mu=</span><span class="si">{</span><span class="n">mu1</span><span class="si">}</span><span class="s1">, M=</span><span class="si">{</span><span class="n">M1</span><span class="o">/</span><span class="mf">1e6</span><span class="si">}</span><span class="s1"> x $10^6$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span><span class="n">OmegaPhi2</span><span class="o">/</span> <span class="p">(</span><span class="n">M2</span> <span class="o">*</span> <span class="n">MTSUN_SI</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;mu=</span><span class="si">{</span><span class="n">mu2</span><span class="si">}</span><span class="s1">, M=</span><span class="si">{</span><span class="n">M2</span><span class="o">/</span><span class="mf">1e6</span><span class="si">}</span><span class="s1"> x $10^6$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Omega_\varphi$ [1/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/885f52221e447b5e73beed68d32d45790c8f2526653778f91a631f1ce1592eb0.png" src="_images/885f52221e447b5e73beed68d32d45790c8f2526653778f91a631f1ce1592eb0.png" />
</div>
</div>
<p>The system with smaller MBH mass spans more frequencies and evolves more quickly than the system with larger MBH mass. This piece of code will be exceptionally useful for a later exercise. Understand here that, for the <span class="math notranslate nohighlight">\(\phi\)</span> angular frequency <span class="math notranslate nohighlight">\(m\Omega_{\phi}\)</span>, we can determine up to what mode in <span class="math notranslate nohighlight">\(m\)</span> we are sensitive to when analysing EMRI waveforms.</p>
</section>
</section>
<section id="schwarzchild-waveforms-in-the-source-frame">
<h2>Schwarzchild Waveforms in the source frame<a class="headerlink" href="#schwarzchild-waveforms-in-the-source-frame" title="Permalink to this heading">#</a></h2>
<p>Here we show how to get the final waveform using the input parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">few_gen</span> <span class="o">=</span> <span class="n">FastSchwarzschildEccentricFlux</span><span class="p">(</span>
    <span class="n">inspiral_kwargs</span><span class="o">=</span><span class="n">inspiral_kwargs</span><span class="p">,</span>
    <span class="n">amplitude_kwargs</span><span class="o">=</span><span class="n">amplitude_kwargs</span><span class="p">,</span>
    <span class="n">Ylm_kwargs</span><span class="o">=</span><span class="n">Ylm_kwargs</span><span class="p">,</span>
    <span class="n">sum_kwargs</span><span class="o">=</span><span class="n">sum_kwargs</span><span class="p">,</span>
    <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle in source frame</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle in source frame</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span><span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>  <span class="c1">#  assumes dt = 10.0 for max T = 0.01 year</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">[:</span><span class="mi">400</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">imag</span><span class="p">[:</span><span class="mi">400</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/546fc5daa2e74b4e6f527bf83734db052a2a4a64d7faeb4c7988919110f8ac11.png" src="_images/546fc5daa2e74b4e6f527bf83734db052a2a4a64d7faeb4c7988919110f8ac11.png" />
</div>
</div>
</section>
<section id="emri-waveforms-in-different-domains">
<h2>EMRI Waveforms in different domains<a class="headerlink" href="#emri-waveforms-in-different-domains" title="Permalink to this heading">#</a></h2>
<p>The output of FEW is a time domain waveform, i.e. the dimensionless strain as a function of time. We are working on providing waveforms directly in Fourier and Time-Frequency domain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle in source frame</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle in source frame</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="c1"># notice that we are providing the distance parameter</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>  <span class="c1">#  assumes dt = 10.0 for max T = 1.0 year</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">))</span><span class="o">*</span><span class="n">dt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-domain">
<h2>Time Domain<a class="headerlink" href="#time-domain" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">,</span> <span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$h_+$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [years]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e1ad0615a1a84177627893a8bbda66a813075e839b52d92fc3b7010b3f3bf506.png" src="_images/e1ad0615a1a84177627893a8bbda66a813075e839b52d92fc3b7010b3f3bf506.png" />
</div>
</div>
</section>
<section id="fourier-domain">
<h2>Fourier Domain<a class="headerlink" href="#fourier-domain" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load Power Spectral Density of LISA. This represents how loud the instrumental noise is.</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s2">&quot;LPA.txt&quot;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span> <span class="n">PSD</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">noise</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">noise</span><span class="p">[</span><span class="s2">&quot;ASD&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># here we use a cubic spline to interpolate the PSD</span>
<span class="n">sens_fn</span> <span class="o">=</span> <span class="n">CubicSplineInterpolant</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">PSD</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we take the Fast Fourier transform of the signal</span>
<span class="n">hp_fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>
<span class="n">hx_fft</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>

<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">),</span><span class="n">dt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hx_fft</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">PSD</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;LISA Sensitivity curve&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$|\tilde</span><span class="si">{h}</span><span class="s1">(f)|^2$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;f [Hz]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fa32bf508461ebb554e0917861d92d671a9f553c98f16c0eb274436716cccf98.png" src="_images/fa32bf508461ebb554e0917861d92d671a9f553c98f16c0eb274436716cccf98.png" />
</div>
</div>
<p>We define the inner product:
$<span class="math notranslate nohighlight">\(
&lt;{a (t)}|{b (t)}&gt; =4 \Re \int _{0} ^\infty \frac{\tilde{a} ^* (f) \tilde{b} (f) }{S_n (f)} \, {\rm d} f \, .
\)</span><span class="math notranslate nohighlight">\(
where the tilde indicates the Fourier transform, the symbol \)</span>^*<span class="math notranslate nohighlight">\( indicates the complex conjugation, and \)</span>S_n (f)<span class="math notranslate nohighlight">\( is the one-sided noise power spectral density, which can be interpreted as the size of the root mean square fluctuations at a given frequency \)</span>\Delta n <em>{\text{rms}} \sim \sqrt{S_n(f) \Delta f}<span class="math notranslate nohighlight">\(. From a practical point of view the spectral density represents our information on the detector sensitivity and the aforementioned inner product can be used to quantify the Signal to Noise Ratio (SNR) of a waveform \)</span>h(t)<span class="math notranslate nohighlight">\(:
\)</span><span class="math notranslate nohighlight">\(
{\rm SNR}^2 =&lt;{h (t)}|{h (t)}&gt; =4 \Re \int _{0} ^\infty \frac{|\tilde{h} (f)| }{S_n (f)} \, {\rm d} f \approx 4 \Re \sum_{i=0}^{N/2 - 1}\frac{|\tilde{h}(f_{i})|^2}{S_{n}(f_{i})}\Delta f\, .
\)</span><span class="math notranslate nohighlight">\(
for \)</span>\Delta f<span class="math notranslate nohighlight">\( the spacing between frequencies defined by \)</span>\Delta f = 1/N\Delta t = 1/T</em>{\text{observation}}<span class="math notranslate nohighlight">\(. 
EMRIs are usually considered to be detectable for \)</span>SNR\gtrsim 15$ or so</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inner_product</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">dt</span><span class="p">):</span>
    <span class="n">a_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">b_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">freq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">psd_f</span> <span class="o">=</span> <span class="n">sens_fn</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">a_tilde</span><span class="p">)</span> <span class="o">*</span> <span class="n">b_tilde</span> <span class="o">*</span> <span class="n">df</span> <span class="o">/</span> <span class="n">psd_f</span><span class="p">)</span> <span class="p">)</span>

<span class="c1"># the SNR of the previous waveform is</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">inner_product</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">dt</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SNR =&quot;</span><span class="p">,</span><span class="n">SNR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SNR = 115.1163351387092
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/homebrew/anaconda3/envs/few_env/lib/python3.7/site-packages/few-1.4.6-py3.7-macosx-10.9-x86_64.egg/few/summation/interpolatedmodesum.py:202: UserWarning: New t array outside bounds of input t array. These points are filled with edge values.
  &quot;New t array outside bounds of input t array. These points are filled with edge values.&quot;
</pre></div>
</div>
</div>
</div>
<section id="exercise-5">
<h3>Exercise 5<a class="headerlink" href="#exercise-5" title="Permalink to this heading">#</a></h3>
<p>Verify that the SNR of an EMRI waveform is:</p>
<ul class="simple">
<li><p>inversely proportional to the distance</p></li>
<li><p>directly proportional to the secondary mass <code class="docutils literal notranslate"><span class="pre">mu</span></code> for fixed total Mass and duration. Make sure that the source does not plunge before the times provided. Otherwise, you might not get the direct proportionality, i.e. set T=<code class="docutils literal notranslate"><span class="pre">0.001</span></code> and vary <span class="math notranslate nohighlight">\(\mu\in[10,100]\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your turn</span>

<span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle in source frame</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle in source frame</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="c1"># plt.figure()</span>
<span class="c1"># for dd in np.linspace(1.0,5.0,num=10):</span>
<span class="c1">#     wave = few_gen(M, mu, p0, e0, theta, phi, dist=dd, dt=dt, T=0.001)</span>
<span class="c1">#     SNR = [INSERT YOUR CODE HERE ] </span>
<span class="c1">#     plt.plot([INSERT YOUR CODE HERE]) </span>
    
<span class="c1"># plt.xlabel(&#39;1/d&#39;)</span>
<span class="c1"># plt.ylabel(&#39;SNR&#39;)</span>
<span class="c1"># plt.show()</span>


<span class="c1"># plt.figure()</span>
<span class="c1"># for mu in np.linspace(1.0,100.0,num=10):</span>
<span class="c1">#     wave = few_gen(M, mu, p0, e0, theta, phi, dist=1.0, dt=dt, T=0.001)</span>
<span class="c1">#     SNR = [INSERT YOUR CODE HERE]</span>
<span class="c1">#     plt.plot([INSERT YOUR CODE HERE])</span>
<span class="c1"># plt.xlabel(&#39;mu&#39;)</span>
<span class="c1"># plt.ylabel(&#39;SNR&#39;)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
<p>We will now introduce another quantity which will be useful for estimating qualitatively how different two waveforms <span class="math notranslate nohighlight">\(a(t)\)</span> and <span class="math notranslate nohighlight">\(b(t)\)</span> are. We define the ehe Overlap <span class="math notranslate nohighlight">\(\mathcal{O}(a,b)\)</span> between two waveform models <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> by:
$<span class="math notranslate nohighlight">\(
\mathcal{O} (a,b) = \frac{&lt;{a}|{b}&gt;}{\sqrt{&lt;{a}|{a}&gt;} \sqrt{&lt;{b}|{b}&gt;}} \in [-1,1] \, .
\)</span><span class="math notranslate nohighlight">\(
The overlap expresses how similar two signals \)</span>a<span class="math notranslate nohighlight">\( and \)</span>b<span class="math notranslate nohighlight">\( by weighting the product with the power spectral density of the detector \)</span>S_n (f)$. If two signals are identical then the overlap is 1. Another quantity often used in gravitational wave data analysis is the mismatch which is defined as 1 minus the overlap.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">overlap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">dt</span><span class="p">):</span>
    <span class="n">a_b</span> <span class="o">=</span> <span class="n">inner_product</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">a_a</span> <span class="o">=</span> <span class="n">inner_product</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">b_b</span> <span class="o">=</span> <span class="n">inner_product</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a_b</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a_a</span> <span class="o">*</span> <span class="n">b_b</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;overlap of a signal with itself = &quot;</span><span class="p">,</span><span class="n">overlap</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">dt</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>overlap of a signal with itself =  1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle in source frame</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle in source frame</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">base_sig</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">t_base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">base_sig</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;inferno&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_base</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span><span class="n">base_sig</span><span class="o">.</span><span class="n">real</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Overlap&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$h_+$&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">phase</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">phase</span><span class="p">)</span>
    <span class="n">t_wave</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">O</span> <span class="o">=</span> <span class="n">overlap</span><span class="p">(</span><span class="n">base_sig</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_wave</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">],</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">],</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">phase</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;time [seconds]&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">phase</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">)))</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/391a631a6cca57ac6c2d7c88d49a6bf9276e942ce564210e7e6e45cbc969be6e.png" src="_images/391a631a6cca57ac6c2d7c88d49a6bf9276e942ce564210e7e6e45cbc969be6e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle in source frame</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle in source frame</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;inferno&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\log_</span><span class="si">{10}</span><span class="s1">\delta e$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Overlap&#39;</span><span class="p">)</span>
<span class="n">vec</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Here we will add small perturbations to parameters </span>
<span class="n">logd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>

<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]:</span>
    <span class="n">base_sig</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
    <span class="n">O</span><span class="o">=</span><span class="p">[]</span>    
    <span class="k">for</span> <span class="n">delta</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
        <span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">delta</span><span class="p">),</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
        <span class="n">O</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">overlap</span><span class="p">(</span><span class="n">base_sig</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">dt</span><span class="p">))</span>

    <span class="n">axs</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">logd</span><span class="p">,</span> <span class="n">O</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;T=</span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ee0be0bafba60c3df4925b38684a049f96bd252b99f403008b3eaf5eee429c2d.png" src="_images/ee0be0bafba60c3df4925b38684a049f96bd252b99f403008b3eaf5eee429c2d.png" />
</div>
</div>
</section>
<section id="exercise-6">
<h3>Exercise 6<a class="headerlink" href="#exercise-6" title="Permalink to this heading">#</a></h3>
<p>Repeat the previous plot by varying each of the EMRI parameters. Which parameter makes the overlap drop faster?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # your turn</span>

<span class="c1"># # parameters</span>
<span class="c1"># M = 1e6</span>
<span class="c1"># mu = 1e2</span>
<span class="c1"># p0 = 12.0</span>
<span class="c1"># e0 = 0.4</span>
<span class="c1"># theta = np.pi/3  # polar viewing angle in source frame</span>
<span class="c1"># phi = np.pi/4  # azimuthal viewing angle in source frame</span>
<span class="c1"># dt = 10.0</span>
<span class="c1"># T = 0.01</span>

<span class="c1"># cmap = matplotlib.cm.get_cmap(&#39;inferno&#39;)</span>
<span class="c1"># fig, axs = plt.subplots(1, 1)</span>
<span class="c1"># axs.set_xlabel(&#39;$\log_{10}\delta e$&#39;)</span>
<span class="c1"># axs.set_ylabel(&#39;Overlap&#39;)</span>
<span class="c1"># vec = 10**np.linspace(-6, -2,num=10)</span>
<span class="c1"># logd = np.log10(vec)</span>

<span class="c1"># T=0.01</span>
<span class="c1"># base_sig = few_gen(M, mu, p0, e0, theta, phi, dist=1.0, dt=dt, T=T)</span>
<span class="c1"># # M</span>
<span class="c1"># O=[]    </span>
<span class="c1"># for delta in vec:</span>
<span class="c1">#     wave = few_gen([INSERT CODE HERE], mu, p0, e0, theta, phi, dist=1.0, dt=dt, T=T)</span>
<span class="c1">#     O.append(overlap(base_sig.real,wave.real,dt))</span>

<span class="c1"># axs.scatter(logd, O , label=f&#39;M&#39;)</span>

<span class="c1"># # mu</span>
<span class="c1"># O=[]    </span>
<span class="c1"># for delta in vec:</span>
<span class="c1">#     wave = few_gen(M, [INSERT CODE HERE], p0, e0, theta, phi, dist=1.0, dt=dt, T=T)</span>
<span class="c1">#     O.append(overlap(base_sig.real,wave.real,dt))</span>

<span class="c1"># axs.scatter(logd, O , label=f&#39;mu&#39;)</span>

<span class="c1"># # p0</span>
<span class="c1"># O=[]    </span>
<span class="c1"># for delta in vec:</span>
<span class="c1">#     wave = few_gen(M, mu, [INSERT CODE HERE], e0, theta, phi, dist=1.0, dt=dt, T=T)</span>
<span class="c1">#     O.append(overlap(base_sig.real,wave.real,dt))</span>

<span class="c1"># axs.scatter(logd, O , label=f&#39;p0&#39;)</span>


<span class="c1"># plt.legend()</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="time-frequency-domain">
<h2>Time-Frequency Domain<a class="headerlink" href="#time-frequency-domain" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle in source frame()</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle in source frame</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="c1"># short fourier transform of the signal</span>
<span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Zxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Zxx</span><span class="p">)),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cb</span><span class="p">,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;STFT Magnitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [sec]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2c0976e8b59dc6a40332ee0680bf00c8d9e8ff29ca143208efdde50723323b00.png" src="_images/2c0976e8b59dc6a40332ee0680bf00c8d9e8ff29ca143208efdde50723323b00.png" />
</div>
</div>
<section id="exercise-7">
<h3>Exercise 7<a class="headerlink" href="#exercise-7" title="Permalink to this heading">#</a></h3>
<p>In the previous plot the different harmonics of the waveform can be recognized as tracks in time-frequency space. As exercise, try to plot the frequency tracks as a function of time on top of the previous plot. Take the same input parameters and run a trajectory to obtain the <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">e</span></code> evolution. Then pass these arrays into the the function <code class="docutils literal notranslate"><span class="pre">get_fundamental_frequencies</span></code> and obtain the three fundamental frequencies. Then convert to the correct units and plot the frequency <span class="math notranslate nohighlight">\(f=(m \Omega_\varphi + n \Omega_r)/(2\pi)\)</span> for some values of your choice for <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(n\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your turn</span>

<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle in source frame</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle in source frame</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Zxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

<span class="n">time</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">OmegaPhi</span><span class="p">,</span> <span class="n">OmegaTheta</span><span class="p">,</span> <span class="n">OmegaR</span> <span class="o">=</span> <span class="n">get_fundamental_frequencies</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fharmonics_phi</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">*</span><span class="n">OmegaPhi</span> <span class="o">/</span> <span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">MTSUN_SI</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">fharmonics_r</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">OmegaR</span> <span class="o">/</span> <span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">MTSUN_SI</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">f_combo_r_phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">OmegaPhi</span> <span class="o">+</span> <span class="n">n</span><span class="o">*</span><span class="n">OmegaR</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">MTSUN_SI</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Zxx</span><span class="p">)),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">fharmonics_phi</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="c1">#     plt.plot(time,fharmonics_r[j],&#39;white&#39;, linestyle=&#39;--&#39;)\</span>
<span class="c1">#     plt.plot(time,f_combo_r_phi, c = &#39;red&#39;, linestyle = &#39;--&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cb</span><span class="p">,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;STFT Magnitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [sec]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/10d0ac265bd9c234c93d726d138c029349bd2868a6075613aafc7de964b724dd.png" src="_images/10d0ac265bd9c234c93d726d138c029349bd2868a6075613aafc7de964b724dd.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="end-of-tutorial">
<h1>End of Tutorial<a class="headerlink" href="#end-of-tutorial" title="Permalink to this heading">#</a></h1>
<section id="exercise-3">
<h2>Exercise 3<a class="headerlink" href="#exercise-3" title="Permalink to this heading">#</a></h2>
<p>Make the following plots</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">OmegaPhi</span> <span class="pre">/OmegaR</span></code> as a function of time for different values of <code class="docutils literal notranslate"><span class="pre">e0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OmegaPhi</span> <span class="pre">/OmegaTheta</span></code> as a function of time for different values of <code class="docutils literal notranslate"><span class="pre">e0</span></code></p></li>
</ul>
<p>Then make a note of what you observe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">400</span>
<span class="k">for</span> <span class="n">e0</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">xI</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                                  <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">OmegaPhi</span><span class="p">,</span> <span class="n">OmegaTheta</span><span class="p">,</span> <span class="n">OmegaR</span> <span class="o">=</span> <span class="n">get_fundamental_frequencies</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="c1"># we need to divide by the total Mass and convert to seconds</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">,</span><span class="n">OmegaPhi</span> <span class="o">/</span><span class="n">OmegaR</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;e0=</span><span class="si">{</span><span class="n">e0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">,</span><span class="n">OmegaPhi</span> <span class="o">/</span><span class="n">OmegaTheta</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;e0=</span><span class="si">{</span><span class="n">e0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Omega_\varphi/\Omega_r$ &#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Omega_\varphi/\Omega_\theta$ &#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t [years]&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/054634ec82d250c24623c627ebef55365d2f3e9071af08ffa9323c05c238c8aa.png" src="_images/054634ec82d250c24623c627ebef55365d2f3e9071af08ffa9323c05c238c8aa.png" />
</div>
</div>
</section>
<section id="augmented-analytic-kludge-with-5pn-trajectory">
<h2>Augmented Analytic Kludge with 5PN trajectory<a class="headerlink" href="#augmented-analytic-kludge-with-5pn-trajectory" title="Permalink to this heading">#</a></h2>
<p>We have now implemented a new version of the Augmented Analytic Kludge with 5PN trajectories.</p>
<p>Waveforms are generated based on the Augmented Analytic Kludge given in the <a class="reference external" href="https://github.com/alvincjk/EMRI_Kludge_Suite/">EMRI Kludge Suite</a>. However, here the trajectory is vastly improved by employing the 5PN fluxes for generic Kerr orbits from <a class="reference external" href="https://arxiv.org/abs/2008.13554">Fujita &amp; Shibata (2020)</a>.</p>
<p>The 5PN trajectory produces orbital and phase trajectories. The trajectory is calculated until the orbit reaches within 0.2 of the separatrix, determined from <a class="reference external" href="https://arxiv.org/abs/1912.07609/">Stein and Warburton (2020)</a>. The
fundamental frequencies along the trajectory at each point are then calculated from the orbital parameters and the spin value given by <a class="reference external" href="https://arxiv.org/abs/gr-qc/0202090%3E">Schmidt (2002)</a>.</p>
<p>These frequencies along the trajectory are then used to map to the frequency basis of the <a class="reference external" href="https://arxiv.org/abs/gr-qc/0310125">Analytic Kludge</a>. This mapping takes the form of time evolving large mass and spin parameters, as
well as the use of phases and frequencies in <span class="math notranslate nohighlight">\(\alpha, \Phi, \gamma\)</span>:</p>
<p>\begin{align}
\Phi &amp;= \Phi_\phi, \
\gamma &amp;= \Phi_\phi + \Phi_\theta, \
\alpha &amp;= \Phi_\phi + \Phi_\theta + \Phi_r. \
\end{align}</p>
<p>The frequencies in that basis are found by taking the time derivatives
of each equation above.</p>
<p><strong>Please note:</strong> the 5PN trajectory and AAK waveform take the parameter <span class="math notranslate nohighlight">\(Y\equiv\cos{\iota}=L/\sqrt{L^2 + Q}\)</span> rather than <span class="math notranslate nohighlight">\(x_I\)</span> as is accepted for relativistic waveforms and in the generic waveform interface discussed above. The generic waveform interface directly converts <span class="math notranslate nohighlight">\(x_I\)</span> to <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<p>This class has GPU capabilities and works from the sparse trajectory methodoligy with cubic spine interpolation of the smoothly varying waveform quantities. This waveform does not have the freedom in terms of user-chosen quantitites that
<code class="docutils literal notranslate"><span class="pre">few.waveform.SchwarzschildEccentricWaveformBase</span></code> contains. This is mainly due to the specific waveform constructions particular to the AAK/AK.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">use_gpu</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># keyword arguments for inspiral generator (RunKerrGenericPn5Inspiral)</span>
<span class="n">inspiral_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;DENSE_STEPPING&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># we want a sparsely sampled trajectory</span>
    <span class="s2">&quot;max_init_len&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e3</span><span class="p">),</span>  <span class="c1"># all of the trajectories will be well under len = 1000</span>
<span class="p">}</span>

<span class="c1"># keyword arguments for summation generator (AAKSummation)</span>
<span class="n">sum_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;use_gpu&quot;</span><span class="p">:</span> <span class="n">use_gpu</span><span class="p">,</span>  <span class="c1"># GPU is available for this type of summation</span>
    <span class="s2">&quot;pad_output&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">wave_generator</span> <span class="o">=</span> <span class="n">Pn5AAKWaveform</span><span class="p">(</span><span class="n">inspiral_kwargs</span><span class="o">=</span><span class="n">inspiral_kwargs</span><span class="p">,</span> <span class="n">sum_kwargs</span><span class="o">=</span><span class="n">sum_kwargs</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">14.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">iota0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iota0</span><span class="p">)</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">0.8</span>


<span class="n">qS</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">phiS</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">qK</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">phiK</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">mich</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="n">waveform</span> <span class="o">=</span> <span class="n">wave_generator</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span> <span class="n">qS</span><span class="p">,</span> <span class="n">phiS</span><span class="p">,</span> <span class="n">qK</span><span class="p">,</span> <span class="n">phiK</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> 
                          <span class="n">Phi_phi0</span><span class="o">=</span><span class="n">Phi_phi0</span><span class="p">,</span> <span class="n">Phi_theta0</span><span class="o">=</span><span class="n">Phi_theta0</span><span class="p">,</span> <span class="n">Phi_r0</span><span class="o">=</span><span class="n">Phi_r0</span><span class="p">,</span> <span class="n">mich</span><span class="o">=</span><span class="n">mich</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">waveform</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">waveform</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">waveform</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f77f09dabd0&gt;]
</pre></div>
</div>
<img alt="_images/329fb289eff199059dac2af75ccfe5f6c99d389517c1a93d7b1287e3db7aa812.png" src="_images/329fb289eff199059dac2af75ccfe5f6c99d389517c1a93d7b1287e3db7aa812.png" />
</div>
</div>
<p>We can also assume a long-wavelength LISA response by setting <code class="docutils literal notranslate"><span class="pre">mich=True</span></code>. Please note this is not Time-delay interferometry (TDI).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">waveform_lw</span> <span class="o">=</span> <span class="n">wave_generator</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span> <span class="n">qS</span><span class="p">,</span> <span class="n">phiS</span><span class="p">,</span> <span class="n">qK</span><span class="p">,</span> <span class="n">phiK</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">mich</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">waveform_lw</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">waveform_lw</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">waveform_lw</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe13751b050&gt;]
</pre></div>
</div>
<img alt="_images/54c8a350c2ac816d83ceb6398ae696c2e997484afef67ea7693de01fa7fa50f5.png" src="_images/54c8a350c2ac816d83ceb6398ae696c2e997484afef67ea7693de01fa7fa50f5.png" />
</div>
</div>
<section id="pn-trajectory">
<h3>5PN Trajectory<a class="headerlink" href="#pn-trajectory" title="Permalink to this heading">#</a></h3>
<p>This new waveform includes 5PN trajectories from <a class="reference external" href="https://arxiv.org/abs/2008.13554">Fujita &amp; Shibata 2020</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize trajectory class</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;pn5&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">14.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">iota0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iota0</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">3.0</span>


<span class="c1"># run trajectory</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">Phi_theta</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span> 
                                             <span class="n">Phi_phi0</span><span class="o">=</span><span class="n">Phi_phi0</span><span class="p">,</span> <span class="n">Phi_theta0</span><span class="o">=</span><span class="n">Phi_theta0</span><span class="p">,</span> <span class="n">Phi_r0</span><span class="o">=</span><span class="n">Phi_r0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">p</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>140 4.530571061589189
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$Y$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_\phi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_r$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_\theta$&#39;</span><span class="p">]</span>
<span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">]</span>
<span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xlab</span><span class="p">,</span> <span class="n">ylab</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c2c3608334c39c8e1985efd0ef11935bf6e5228504e2dedab2267473259e0ce9.png" src="_images/c2c3608334c39c8e1985efd0ef11935bf6e5228504e2dedab2267473259e0ce9.png" />
</div>
</div>
<p>With the PN trajectory, we need to be careful at smaller <span class="math notranslate nohighlight">\(p\)</span>, larger <span class="math notranslate nohighlight">\(a\)</span>, and larger <span class="math notranslate nohighlight">\(e\)</span>. This trajectory can exihibt pathological behavior near these extremes. Therefore, we provide the option to truncate the trajectory at the Schwarzschild (<span class="math notranslate nohighlight">\(a=0\)</span>) separatrix, <span class="math notranslate nohighlight">\(6 + 2e\)</span>. To do this, you provide the keyword <code class="docutils literal notranslate"><span class="pre">enforce_schwarz_sep=True</span></code> to the initialization of the class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize trajectory class</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;pn5&quot;</span><span class="p">,</span> <span class="n">enforce_schwarz_sep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">14.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">iota0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iota0</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">3.0</span>


<span class="c1"># run trajectory</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">Phi_theta</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span> 
                                             <span class="n">Phi_phi0</span><span class="o">=</span><span class="n">Phi_phi0</span><span class="p">,</span> <span class="n">Phi_theta0</span><span class="o">=</span><span class="n">Phi_theta0</span><span class="p">,</span> <span class="n">Phi_r0</span><span class="o">=</span><span class="n">Phi_r0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">p</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>104 6.549942276116756
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$Y$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_\phi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_r$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_\theta$&#39;</span><span class="p">]</span>
<span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">]</span>
<span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xlab</span><span class="p">,</span> <span class="n">ylab</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/adbd1c5b454da6137e6711a22f1b7dc57099cf3024bbbac109ba3be13e0edc52.png" src="_images/adbd1c5b454da6137e6711a22f1b7dc57099cf3024bbbac109ba3be13e0edc52.png" />
</div>
</div>
</section>
<section id="building-an-aak-waveform-from-a-given-trajectory-in-this-case-the-5pn-trajectory">
<h3>Building an AAK waveform from a given trajectory (in this case the 5PN trajectory)<a class="headerlink" href="#building-an-aak-waveform-from-a-given-trajectory-in-this-case-the-5pn-trajectory" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">few.utils.baseclasses</span> <span class="kn">import</span> <span class="n">Pn5AAK</span><span class="p">,</span> <span class="n">ParallelModuleBase</span>

<span class="k">class</span> <span class="nc">NewPn5AAKWaveform</span><span class="p">(</span><span class="n">AAKWaveformBase</span><span class="p">,</span> <span class="n">Pn5AAK</span><span class="p">,</span> <span class="n">ParallelModuleBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">inspiral_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">sum_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_threads</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>

        <span class="n">inspiral_kwargs</span><span class="p">[</span><span class="s2">&quot;func&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pn5&quot;</span>

        <span class="n">AAKWaveformBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">EMRIInspiral</span><span class="p">,</span>  <span class="c1"># trajectory class</span>
            <span class="n">AAKSummation</span><span class="p">,</span>
            <span class="n">inspiral_kwargs</span><span class="o">=</span><span class="n">inspiral_kwargs</span><span class="p">,</span>
            <span class="n">sum_kwargs</span><span class="o">=</span><span class="n">sum_kwargs</span><span class="p">,</span>
            <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">,</span>
            <span class="n">num_threads</span><span class="o">=</span><span class="n">num_threads</span><span class="p">,</span>
        <span class="p">)</span>

        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">14.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">iota0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iota0</span><span class="p">)</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">0.8</span>


<span class="n">qS</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">phiS</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">qK</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">phiK</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">mich</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="n">wave_generator</span> <span class="o">=</span> <span class="n">NewPn5AAKWaveform</span><span class="p">()</span>
<span class="n">AAK_out</span> <span class="o">=</span> <span class="n">wave_generator</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span> <span class="n">qS</span><span class="p">,</span> <span class="n">phiS</span><span class="p">,</span> <span class="n">qK</span><span class="p">,</span> <span class="n">phiK</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> 
                          <span class="n">Phi_phi0</span><span class="o">=</span><span class="n">Phi_phi0</span><span class="p">,</span> <span class="n">Phi_theta0</span><span class="o">=</span><span class="n">Phi_theta0</span><span class="p">,</span> <span class="n">Phi_r0</span><span class="o">=</span><span class="n">Phi_r0</span><span class="p">,</span> <span class="n">mich</span><span class="o">=</span><span class="n">mich</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AAK_out</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AAK_out</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe11d66dc90&gt;]
</pre></div>
</div>
<img alt="_images/86f05f6050f3e4066aea55ba5c6831559cc38ef006406c5cd0a4d3810cfd7022.png" src="_images/86f05f6050f3e4066aea55ba5c6831559cc38ef006406c5cd0a4d3810cfd7022.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AAK_out</span><span class="o">.</span><span class="n">real</span><span class="p">[:</span><span class="mi">400</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AAK_out</span><span class="o">.</span><span class="n">imag</span><span class="p">[:</span><span class="mi">400</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe0f11ca190&gt;]
</pre></div>
</div>
<img alt="_images/9ff11318a9443f84abbefefb49c87240077948ca812f5ac44be2a02cdbed53a7.png" src="_images/9ff11318a9443f84abbefefb49c87240077948ca812f5ac44be2a02cdbed53a7.png" />
</div>
</div>
</section>
<section id="generating-the-new-aak-with-the-generic-waveform-generator">
<h3>Generating the new AAK with the generic waveform generator<a class="headerlink" href="#generating-the-new-aak-with-the-generic-waveform-generator" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_wave</span> <span class="o">=</span> <span class="n">GenerateEMRIWaveform</span><span class="p">(</span><span class="s2">&quot;Pn5AAKWaveform&quot;</span><span class="p">)</span>

<span class="c1"># parameters</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># years</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span>  <span class="c1"># seconds</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.1</span> 
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.6</span>  <span class="c1"># notice this is x_I, not Y. The AAK waveform can convert to Y. </span>
<span class="n">qK</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># polar spin angle</span>
<span class="n">phiK</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">qS</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># polar sky angle</span>
<span class="n">phiS</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># distance</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">3.0</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">gen_wave</span><span class="p">(</span>
    <span class="n">M</span><span class="p">,</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">a</span><span class="p">,</span>
    <span class="n">p0</span><span class="p">,</span>
    <span class="n">e0</span><span class="p">,</span>
    <span class="n">x0</span><span class="p">,</span>
    <span class="n">dist</span><span class="p">,</span>
    <span class="n">qS</span><span class="p">,</span>
    <span class="n">phiS</span><span class="p">,</span>
    <span class="n">qK</span><span class="p">,</span>
    <span class="n">phiK</span><span class="p">,</span>
    <span class="n">Phi_phi0</span><span class="p">,</span>
    <span class="n">Phi_theta0</span><span class="p">,</span>
    <span class="n">Phi_r0</span><span class="p">,</span>
    <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">real</span><span class="p">[:</span><span class="mi">2000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe0f14fb350&gt;]
</pre></div>
</div>
<img alt="_images/fff4b9ed6c0de6a1e4a85fc8fbc882399fc2773c3bcae085e11091cc1bc0f5ce.png" src="_images/fff4b9ed6c0de6a1e4a85fc8fbc882399fc2773c3bcae085e11091cc1bc0f5ce.png" />
</div>
</div>
</section>
</section>
<section id="mode-selection-for-schwarszchild-waveforms">
<h2>Mode Selection for Schwarszchild Waveforms<a class="headerlink" href="#mode-selection-for-schwarszchild-waveforms" title="Permalink to this heading">#</a></h2>
<p>The mode selection module is paramount to the computational efficiency of this model. Below we show how we perform this selection operation by moving from a set of amplitudes to only those that contribute.</p>
<section id="mode-selection-by-power-contribution">
<h3>Mode selection by power contribution<a class="headerlink" href="#mode-selection-by-power-contribution" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first, lets get amplitudes for a trajectory</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;SchwarzEccFlux&quot;</span><span class="p">)</span>

<span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span>

<span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># get amplitudes along trajectory</span>
<span class="n">amp</span> <span class="o">=</span> <span class="n">RomanAmplitude</span><span class="p">()</span>

<span class="n">teuk_modes</span> <span class="o">=</span> <span class="n">amp</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

<span class="c1"># get ylms</span>
<span class="n">ylms</span> <span class="o">=</span> <span class="n">ylm_gen</span><span class="p">(</span><span class="n">amp</span><span class="o">.</span><span class="n">unique_l</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">unique_m</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">amp</span><span class="o">.</span><span class="n">inverse_lm</span><span class="p">]</span>

<span class="c1"># select modes</span>

<span class="n">mode_selector</span> <span class="o">=</span> <span class="n">ModeSelector</span><span class="p">(</span><span class="n">amp</span><span class="o">.</span><span class="n">m0mask</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-5</span>  <span class="c1"># tolerance on mode contribution to total power</span>

<span class="n">modeinds</span> <span class="o">=</span> <span class="p">[</span><span class="n">amp</span><span class="o">.</span><span class="n">l_arr</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">m_arr</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">n_arr</span><span class="p">]</span>
<span class="p">(</span><span class="n">teuk_modes_in</span><span class="p">,</span> <span class="n">ylms_in</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">ns</span><span class="p">)</span> <span class="o">=</span> <span class="n">mode_selector</span><span class="p">(</span><span class="n">teuk_modes</span><span class="p">,</span> <span class="n">ylms</span><span class="p">,</span> <span class="n">modeinds</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We reduced the mode content from </span><span class="si">{}</span><span class="s2"> modes to </span><span class="si">{}</span><span class="s2"> modes.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">teuk_modes_in</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>We reduced the mode content from 3843 modes to 874 modes.
</pre></div>
</div>
</div>
</div>
</section>
<section id="specific-mode-selection">
<h3>Specific mode selection<a class="headerlink" href="#specific-mode-selection" title="Permalink to this heading">#</a></h3>
<p>The user can also select a specific set of modes to use in the waveform.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># l = 2, m = 2 wave</span>
<span class="n">specific_modes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">)]</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">wave_22</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">mode_selection</span><span class="o">=</span><span class="n">specific_modes</span><span class="p">)</span>
<span class="n">wave_base</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave_22</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mismatch with full wave:&#39;</span><span class="p">,</span> <span class="n">get_mismatch</span><span class="p">(</span><span class="n">wave_22</span><span class="p">,</span> <span class="n">wave_base</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mismatch with full wave: 0.07166765726164526
</pre></div>
</div>
<img alt="_images/13eacb37f7d9b4a245acb99235382160ab214ab3dc52800d79afd69bdeb45996.png" src="_images/13eacb37f7d9b4a245acb99235382160ab214ab3dc52800d79afd69bdeb45996.png" />
</div>
</div>
</section>
<section id="producing-waveforms-with-the-generic-interface">
<h3>Producing waveforms with the generic interface<a class="headerlink" href="#producing-waveforms-with-the-generic-interface" title="Permalink to this heading">#</a></h3>
<p>Waveforms can also be generated through a generic interface (<a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/index.html#few.waveform.GenerateEMRIWaveform">GenerateEMRIWaveform</a>) where the specific waveform model is chosen with an argument. This can also be used to produce waveforms in the detector frame used for data analysis. This interface includes all EMRI parameters, including spin and inclination, as well as sky and orientation parameters. When a specific waveform model does not require certain parameters, the parameters will not affect the waveform generation. A detector-frame waveform in this case means <span class="math notranslate nohighlight">\(h_+,h_x\)</span> in the SSB-frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_wave</span> <span class="o">=</span> <span class="n">GenerateEMRIWaveform</span><span class="p">(</span><span class="s2">&quot;FastSchwarzschildEccentricFlux&quot;</span><span class="p">)</span>

<span class="n">T</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">12</span><span class="o">/</span><span class="mi">30</span><span class="o">/</span><span class="mi">24</span>  <span class="c1"># years</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span>  <span class="c1"># seconds</span>

<span class="c1"># parameters</span>
<span class="c1"># intrinsic</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span> 
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># will be ignored in Schwarzschild waveform</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span> <span class="c1"># in range [6+2*e0, 16]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># will be ignored in Schwarzschild waveform</span>

<span class="c1"># extrinsic</span>
<span class="n">qK</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># polar spin angle</span>
<span class="n">phiK</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">qS</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># polar sky angle</span>
<span class="n">phiS</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># distance</span>

<span class="c1"># initial phases</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">1.0</span> 
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">2.0</span> 
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">3.0</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">gen_wave</span><span class="p">(</span>
    <span class="n">M</span><span class="p">,</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">a</span><span class="p">,</span>
    <span class="n">p0</span><span class="p">,</span>
    <span class="n">e0</span><span class="p">,</span>
    <span class="n">x0</span><span class="p">,</span>
    <span class="n">dist</span><span class="p">,</span>
    <span class="n">qS</span><span class="p">,</span>
    <span class="n">phiS</span><span class="p">,</span>
    <span class="n">qK</span><span class="p">,</span>
    <span class="n">phiK</span><span class="p">,</span>
    <span class="n">Phi_phi0</span><span class="p">,</span>
    <span class="n">Phi_theta0</span><span class="p">,</span>
    <span class="n">Phi_r0</span><span class="p">,</span>
    <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Time duration </span><span class="si">{</span><span class="n">T</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> years&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$h_+$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$-h_\times$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [seconds]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0e14282d53159d99e68de389addeefc86b501ea8b1496cd3eb061ffa83b3a88f.png" src="_images/0e14282d53159d99e68de389addeefc86b501ea8b1496cd3eb061ffa83b3a88f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mf">4.0</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">gen_wave</span><span class="p">(</span>
    <span class="n">M</span><span class="p">,</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">a</span><span class="p">,</span>
    <span class="n">p0</span><span class="p">,</span>
    <span class="n">e0</span><span class="p">,</span>
    <span class="n">x0</span><span class="p">,</span>
    <span class="n">dist</span><span class="p">,</span>
    <span class="n">qS</span><span class="p">,</span>
    <span class="n">phiS</span><span class="p">,</span>
    <span class="n">qK</span><span class="p">,</span>
    <span class="n">phiK</span><span class="p">,</span>
    <span class="n">Phi_phi0</span><span class="p">,</span>
    <span class="n">Phi_theta0</span><span class="p">,</span>
    <span class="n">Phi_r0</span><span class="p">,</span>
    <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Time duration </span><span class="si">{</span><span class="n">T</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> years&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$h_+$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$-h_\times$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [seconds]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c672555af28be03d40859d3da9531057757ebd64467462669a0318ab8953255c.png" src="_images/c672555af28be03d40859d3da9531057757ebd64467462669a0318ab8953255c.png" />
</div>
</div>
</section>
</section>
<section id="scaling-of-the-waveform-with-the-central-black-hole-mass">
<h2>Scaling of the waveform with the central black hole mass<a class="headerlink" href="#scaling-of-the-waveform-with-the-central-black-hole-mass" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">dt</span><span class="o">=</span><span class="mi">10</span>
<span class="n">max_FFT</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">6.5</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="o">*</span><span class="n">M</span>
    <span class="n">Tnew</span> <span class="o">=</span> <span class="n">T</span><span class="o">*</span><span class="n">M</span><span class="o">/</span><span class="mf">1e6</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">gen_wave</span><span class="p">(</span>
        <span class="n">M</span><span class="p">,</span>
        <span class="n">mu</span><span class="p">,</span>
        <span class="n">a</span><span class="p">,</span>
        <span class="n">p0</span><span class="p">,</span>
        <span class="n">e0</span><span class="p">,</span>
        <span class="n">x0</span><span class="p">,</span>
        <span class="n">dist</span><span class="p">,</span>
        <span class="n">qS</span><span class="p">,</span>
        <span class="n">phiS</span><span class="p">,</span>
        <span class="n">qK</span><span class="p">,</span>
        <span class="n">phiK</span><span class="p">,</span>
        <span class="n">Phi_phi0</span><span class="p">,</span>
        <span class="n">Phi_theta0</span><span class="p">,</span>
        <span class="n">Phi_r0</span><span class="p">,</span>
        <span class="n">T</span><span class="o">=</span><span class="n">Tnew</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>


    <span class="n">FFT</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">/</span> <span class="n">Tnew</span> <span class="o">/</span><span class="n">mu</span>
    <span class="n">f</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dt</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span><span class="n">M</span><span class="o">*</span><span class="n">MTSUN_SI</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FFT</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">fr</span><span class="s1">&#39;$h_+$, M=</span><span class="si">{</span><span class="n">M</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">, Tinsp=</span><span class="si">{</span><span class="n">Tnew</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">max_FFT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FFT</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">max_FFT</span><span class="p">)</span>
<span class="c1">#     plt.plot(t, h.imag, label=r&#39;$-h_\times$&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Time duration </span><span class="si">{</span><span class="n">T</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> years&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\tilde</span><span class="si">{h}</span><span class="s1">}{\mu \, Tinsp}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f \, M$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100000.0 [3.577329752505046e-18]
237137.37056616554 [3.577329752505046e-18, 3.577004826483748e-18]
562341.3251903491 [3.577329752505046e-18, 3.577004826483748e-18, 3.577083417127196e-18]
1333521.432163324 [3.577329752505046e-18, 3.577004826483748e-18, 3.577083417127196e-18, 3.5771349252280955e-18]
3162277.6601683795 [3.577329752505046e-18, 3.577004826483748e-18, 3.577083417127196e-18, 3.5771349252280955e-18, 3.5771327572085345e-18]
</pre></div>
</div>
<img alt="_images/2287bb01aa88817f8a016bf00aca9602ebeeef493cd020f9346f0735452ea7e0.png" src="_images/2287bb01aa88817f8a016bf00aca9602ebeeef493cd020f9346f0735452ea7e0.png" />
</div>
</div>
</section>
<section id="understanding-the-extrinsic-parameters-in-the-solar-system-barycenter-frame">
<h2>Understanding the extrinsic parameters in the Solar System Barycenter frame<a class="headerlink" href="#understanding-the-extrinsic-parameters-in-the-solar-system-barycenter-frame" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">FancyArrowPatch</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">proj3d</span>

<span class="k">class</span> <span class="nc">Arrow3D</span><span class="p">(</span><span class="n">FancyArrowPatch</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verts3d</span> <span class="o">=</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zs</span>

    <span class="k">def</span> <span class="nf">do_3d_projection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">xs3d</span><span class="p">,</span> <span class="n">ys3d</span><span class="p">,</span> <span class="n">zs3d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verts3d</span>
        <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zs</span> <span class="o">=</span> <span class="n">proj3d</span><span class="o">.</span><span class="n">proj_transform</span><span class="p">(</span><span class="n">xs3d</span><span class="p">,</span> <span class="n">ys3d</span><span class="p">,</span> <span class="n">zs3d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">((</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="n">xs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ys</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>

<span class="c1"># draw the SSB frame</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">arrow_prop_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">Arrow3D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">arrow_prop_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">Arrow3D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">arrow_prop_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">Arrow3D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">arrow_prop_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SSB&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$y$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$z$&#39;</span><span class="p">)</span>


<span class="c1"># sky direction</span>
<span class="n">qS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.9</span>  <span class="c1"># polar sky angle</span>
<span class="n">phiS</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.2</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">th</span><span class="p">,</span> <span class="n">ph</span><span class="p">,</span> <span class="n">lab</span> <span class="o">=</span> <span class="n">qS</span><span class="p">,</span> <span class="n">phiS</span><span class="p">,</span> <span class="s1">&#39;Sky location&#39;</span>
<span class="n">x_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">)</span>
<span class="n">y_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">)</span>
<span class="n">z_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">Arrow3D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">z_</span><span class="p">],</span> <span class="o">**</span><span class="n">arrow_prop_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span><span class="n">y_</span><span class="p">,</span><span class="n">z_</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;source&#39;</span><span class="p">)</span>

<span class="c1"># sky spin</span>
<span class="n">qK</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.2</span>  <span class="c1"># polar spin angle</span>
<span class="n">phiK</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.6</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">th</span><span class="p">,</span> <span class="n">ph</span><span class="p">,</span> <span class="n">lab</span> <span class="o">=</span> <span class="n">qK</span><span class="p">,</span> <span class="n">phiK</span><span class="p">,</span> <span class="s1">&#39;MBH Spin&#39;</span>
<span class="n">x_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">)</span>
<span class="n">y_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">)</span>
<span class="n">z_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">Arrow3D</span><span class="p">([</span><span class="n">x_</span><span class="p">,</span> <span class="n">x_</span><span class="o">+</span><span class="n">x_s</span><span class="p">],</span> <span class="p">[</span><span class="n">y_</span><span class="p">,</span> <span class="n">y_</span><span class="o">+</span><span class="n">y_s</span><span class="p">],</span> <span class="p">[</span><span class="n">z_</span><span class="p">,</span> <span class="n">z_</span><span class="o">+</span><span class="n">z_s</span><span class="p">],</span> <span class="o">**</span><span class="n">arrow_prop_dict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">azim</span><span class="o">=-</span><span class="mi">70</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># generate waveform</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">gen_wave</span><span class="p">(</span>
    <span class="n">M</span><span class="p">,</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">a</span><span class="p">,</span>
    <span class="n">p0</span><span class="p">,</span>
    <span class="n">e0</span><span class="p">,</span>
    <span class="n">x0</span><span class="p">,</span>
    <span class="n">dist</span><span class="p">,</span>
    <span class="n">qS</span><span class="p">,</span>
    <span class="n">phiS</span><span class="p">,</span>
    <span class="n">qK</span><span class="p">,</span>
    <span class="n">phiK</span><span class="p">,</span>
    <span class="n">Phi_phi0</span><span class="p">,</span>
    <span class="n">Phi_theta0</span><span class="p">,</span>
    <span class="n">Phi_r0</span><span class="p">,</span>
    <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [seconds]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b28382b4a2e55ca7918570a6816fe4a71d48589a0837896fe4bb522057cd309f.png" src="_images/b28382b4a2e55ca7918570a6816fe4a71d48589a0837896fe4bb522057cd309f.png" />
<img alt="_images/93de35a865be369c7bfb3189c033d76ebce8f1f73beb67eeab52bacfcfd26bf8.png" src="_images/93de35a865be369c7bfb3189c033d76ebce8f1f73beb67eeab52bacfcfd26bf8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">phase</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">gen_wave</span><span class="p">(</span>
        <span class="n">M</span><span class="p">,</span>
        <span class="n">mu</span><span class="p">,</span>
        <span class="n">a</span><span class="p">,</span>
        <span class="n">p0</span><span class="p">,</span>
        <span class="n">e0</span><span class="p">,</span>
        <span class="n">x0</span><span class="p">,</span>
        <span class="n">dist</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">phase</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">Phi_phi0</span><span class="p">,</span>
        <span class="n">Phi_theta0</span><span class="p">,</span>
        <span class="n">Phi_r0</span><span class="p">,</span>
        <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [seconds]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bf42d552e7fcbfd96d2294a6d052319519108c8462652786f228e10254af11b7.png" src="_images/bf42d552e7fcbfd96d2294a6d052319519108c8462652786f228e10254af11b7.png" />
</div>
</div>
</section>
<section id="citing-waveforms-and-modules">
<h2>Citing waveforms and modules<a class="headerlink" href="#citing-waveforms-and-modules" title="Permalink to this heading">#</a></h2>
<p>If you use any work from this package please cite our papers <a class="reference external" href="https://arxiv.org/abs/2104.04582">arxiv.org/2104.04582</a> and <a class="reference external" href="https://arxiv.org/abs/2008.06071">arxiv.org/2008.06071</a>. Additionally please cite any additional work for each module used by calling the <code class="docutils literal notranslate"><span class="pre">citation</span></code> attribute on the module class:</p>
<section id="fast-schwarzschild-eccentric-waveforms">
<h3>Fast Schwarzschild Eccentric Waveforms<a class="headerlink" href="#fast-schwarzschild-eccentric-waveforms" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span> <span class="o">=</span> <span class="n">FastSchwarzschildEccentricFlux</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">citation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>@article{Katz:2021yft,
    author = &quot;Katz, Michael L. and Chua, Alvin J. K. and Speri, Lorenzo and Warburton, Niels and Hughes, Scott A.&quot;,
    title = &quot;{FastEMRIWaveforms: New tools for millihertz gravitational-wave data analysis}&quot;,
    eprint = &quot;2104.04582&quot;,
    archivePrefix = &quot;arXiv&quot;,
    primaryClass = &quot;gr-qc&quot;,
    month = &quot;4&quot;,
    year = &quot;2021&quot;
}

@article{Chua:2020stf,
    author = &quot;Chua, Alvin J. K. and Katz, Michael L. and Warburton, Niels and Hughes, Scott A.&quot;,
    title = &quot;{Rapid generation of fully relativistic extreme-mass-ratio-inspiral waveform templates for LISA data analysis}&quot;,
    eprint = &quot;2008.06071&quot;,
    archivePrefix = &quot;arXiv&quot;,
    primaryClass = &quot;gr-qc&quot;,
    doi = &quot;10.1103/PhysRevLett.126.051102&quot;,
    journal = &quot;Phys. Rev. Lett.&quot;,
    volume = &quot;126&quot;,
    number = &quot;5&quot;,
    pages = &quot;051102&quot;,
    year = &quot;2021&quot;
}

@software{michael_l_katz_2020_4005001,
  author       = {Michael L. Katz and
                  Alvin J. K. Chua and
                  Niels Warburton and
                  Scott A. Hughes.},
  title        = {{BlackHolePerturbationToolkit/FastEMRIWaveforms:
                   Official Release}},
  month        = aug,
  year         = 2020,
  publisher    = {Zenodo},
  version      = {v1.0.0},
  doi          = {10.5281/zenodo.4005001},
  url          = {https://doi.org/10.5281/zenodo.4005001}
}

@article{Chua:2018woh,
    author = &quot;Chua, Alvin J.K. and Galley, Chad R. and Vallisneri, Michele&quot;,
    title = &quot;{Reduced-order modeling with artificial neurons for gravitational-wave inference}&quot;,
    eprint = &quot;1811.05491&quot;,
    archivePrefix = &quot;arXiv&quot;,
    primaryClass = &quot;astro-ph.IM&quot;,
    doi = &quot;10.1103/PhysRevLett.122.211101&quot;,
    journal = &quot;Phys. Rev. Lett.&quot;,
    volume = &quot;122&quot;,
    number = &quot;21&quot;,
    pages = &quot;211101&quot;,
    year = &quot;2019&quot;
}
</pre></div>
</div>
</div>
</div>
</section>
<section id="new-and-improved-aak-with-5pn-trajectory">
<h3>New and Improved AAK with 5PN Trajectory<a class="headerlink" href="#new-and-improved-aak-with-5pn-trajectory" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave_aak</span> <span class="o">=</span> <span class="n">Pn5AAKWaveform</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wave_aak</span><span class="o">.</span><span class="n">citation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>@article{Katz:2021yft,
    author = &quot;Katz, Michael L. and Chua, Alvin J. K. and Speri, Lorenzo and Warburton, Niels and Hughes, Scott A.&quot;,
    title = &quot;{FastEMRIWaveforms: New tools for millihertz gravitational-wave data analysis}&quot;,
    eprint = &quot;2104.04582&quot;,
    archivePrefix = &quot;arXiv&quot;,
    primaryClass = &quot;gr-qc&quot;,
    month = &quot;4&quot;,
    year = &quot;2021&quot;
}

@article{Chua:2020stf,
    author = &quot;Chua, Alvin J. K. and Katz, Michael L. and Warburton, Niels and Hughes, Scott A.&quot;,
    title = &quot;{Rapid generation of fully relativistic extreme-mass-ratio-inspiral waveform templates for LISA data analysis}&quot;,
    eprint = &quot;2008.06071&quot;,
    archivePrefix = &quot;arXiv&quot;,
    primaryClass = &quot;gr-qc&quot;,
    doi = &quot;10.1103/PhysRevLett.126.051102&quot;,
    journal = &quot;Phys. Rev. Lett.&quot;,
    volume = &quot;126&quot;,
    number = &quot;5&quot;,
    pages = &quot;051102&quot;,
    year = &quot;2021&quot;
}

@software{michael_l_katz_2020_4005001,
  author       = {Michael L. Katz and
                  Alvin J. K. Chua and
                  Niels Warburton and
                  Scott A. Hughes.},
  title        = {{BlackHolePerturbationToolkit/FastEMRIWaveforms:
                   Official Release}},
  month        = aug,
  year         = 2020,
  publisher    = {Zenodo},
  version      = {v1.0.0},
  doi          = {10.5281/zenodo.4005001},
  url          = {https://doi.org/10.5281/zenodo.4005001}
}


@article{Chua:2015mua,
    author = &quot;Chua, Alvin J.K. and Gair, Jonathan R.&quot;,
    title = &quot;{Improved analytic extreme-mass-ratio inspiral model for scoping out eLISA data analysis}&quot;,
    eprint = &quot;1510.06245&quot;,
    archivePrefix = &quot;arXiv&quot;,
    primaryClass = &quot;gr-qc&quot;,
    doi = &quot;10.1088/0264-9381/32/23/232002&quot;,
    journal = &quot;Class. Quant. Grav.&quot;,
    volume = &quot;32&quot;,
    pages = &quot;232002&quot;,
    year = &quot;2015&quot;
}


@article{Chua:2017ujo,
    author = &quot;Chua, Alvin J.K. and Moore, Christopher J. and Gair, Jonathan R.&quot;,
    title = &quot;{Augmented kludge waveforms for detecting extreme-mass-ratio inspirals}&quot;,
    eprint = &quot;1705.04259&quot;,
    archivePrefix = &quot;arXiv&quot;,
    primaryClass = &quot;gr-qc&quot;,
    doi = &quot;10.1103/PhysRevD.96.044005&quot;,
    journal = &quot;Phys. Rev. D&quot;,
    volume = &quot;96&quot;,
    number = &quot;4&quot;,
    pages = &quot;044005&quot;,
    year = &quot;2017&quot;
}

@article{Barack:2003fp,
    author = &quot;Barack, Leor and Cutler, Curt&quot;,
    title = &quot;{LISA capture sources: Approximate waveforms, signal-to-noise ratios, and parameter estimation accuracy}&quot;,
    eprint = &quot;gr-qc/0310125&quot;,
    archivePrefix = &quot;arXiv&quot;,
    doi = &quot;10.1103/PhysRevD.69.082005&quot;,
    journal = &quot;Phys. Rev. D&quot;,
    volume = &quot;69&quot;,
    pages = &quot;082005&quot;,
    year = &quot;2004&quot;
}

@article{Fujita:2020zxe,
    author = &quot;Fujita, Ryuichi and Shibata, Masaru&quot;,
    title = &quot;{Extreme mass ratio inspirals on the equatorial plane in the adiabatic order}&quot;,
    eprint = &quot;2008.13554&quot;,
    archivePrefix = &quot;arXiv&quot;,
    primaryClass = &quot;gr-qc&quot;,
    doi = &quot;10.1103/PhysRevD.102.064005&quot;,
    journal = &quot;Phys. Rev. D&quot;,
    volume = &quot;102&quot;,
    number = &quot;6&quot;,
    pages = &quot;064005&quot;,
    year = &quot;2020&quot;
}

@article{Stein:2019buj,
    author = &quot;Stein, Leo C. and Warburton, Niels&quot;,
    title = &quot;{Location of the last stable orbit in Kerr spacetime}&quot;,
    eprint = &quot;1912.07609&quot;,
    archivePrefix = &quot;arXiv&quot;,
    primaryClass = &quot;gr-qc&quot;,
    doi = &quot;10.1103/PhysRevD.101.064007&quot;,
    journal = &quot;Phys. Rev. D&quot;,
    volume = &quot;101&quot;,
    number = &quot;6&quot;,
    pages = &quot;064007&quot;,
    year = &quot;2020&quot;
}
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="solutions">
<h1>Solutions<a class="headerlink" href="#solutions" title="Permalink to this heading">#</a></h1>
<section id="ex-1">
<h2>Ex 1<a class="headerlink" href="#ex-1" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## # set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="c1"># Fix time duration to a very large number (100 years) so that we obtain the time duration from trajectory</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="c1"># initial time setp, </span>
              <span class="n">T</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span>
              <span class="n">err</span><span class="o">=</span><span class="mf">1e-10</span> <span class="c1"># integrator error</span>
             <span class="p">)</span>

<span class="n">ecc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">tfinal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">e0</span> <span class="ow">in</span> <span class="n">ecc</span><span class="p">:</span>

    <span class="c1"># get secondary mass for fixed mass ratio</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">xI</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                                  <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="n">tfinal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">)</span> 


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ecc</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Time duration [years]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;e0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">############################</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># reset eccentricity</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="k">for</span> <span class="n">p0</span> <span class="ow">in</span> <span class="n">pp</span><span class="p">:</span>

    <span class="c1"># get secondary mass for fixed mass ratio</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">xI</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                                  <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="n">tfinal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">)</span> 


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Time duration [years]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">############################</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># reset</span>
<span class="n">p0</span><span class="o">=</span><span class="mf">10.0</span>
<span class="n">mass_ratio_vector</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Mvec</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">Mvec</span><span class="p">:</span>
    <span class="n">tfinal</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">epsilon</span> <span class="ow">in</span> <span class="n">mass_ratio_vector</span><span class="p">:</span>

        <span class="c1"># get secondary mass for fixed mass ratio</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="n">epsilon</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">xI</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                                      <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                      <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                      <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                      <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># inspiral duration (divide by YRSID_SI to get it in years)</span>
        <span class="n">tfinal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">YRSID_SI</span><span class="p">)</span> 

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">/</span><span class="n">mass_ratio_vector</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Time duration [years]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$M/\epsilon$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0d5f6775f39ad6bde5523b09d209f41c4b8a6261665076230d70016973a5c710.png" src="_images/0d5f6775f39ad6bde5523b09d209f41c4b8a6261665076230d70016973a5c710.png" />
<img alt="_images/1221042a8431de430b50c37a9616d69a776c3d7c46ec7b21e23397dfe2f9cd32.png" src="_images/1221042a8431de430b50c37a9616d69a776c3d7c46ec7b21e23397dfe2f9cd32.png" />
<img alt="_images/b5bfcb3c311449613d07cacc50fc8c20d1216258f5d3c5d1aed96f8332cbeed6.png" src="_images/b5bfcb3c311449613d07cacc50fc8c20d1216258f5d3c5d1aed96f8332cbeed6.png" />
</div>
</div>
</section>
<section id="ex-2">
<h2>Ex 2<a class="headerlink" href="#ex-2" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>

<span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="n">Ncycle</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">epsilon</span> <span class="ow">in</span> <span class="n">mass_ratio_vector</span><span class="p">:</span>

    <span class="c1"># get secondary mass for fixed mass ratio</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="n">epsilon</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">xI</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                                  <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="n">Ncycle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Phi_phi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> 
    

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">mass_ratio_vector</span><span class="p">,</span> <span class="n">Ncycle</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of cycles&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass ratio&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/63620bea61bd789b2f1f7c643f4926c093c2b65ca3ec803a167a5c483d1ce4cd.png" src="_images/63620bea61bd789b2f1f7c643f4926c093c2b65ca3ec803a167a5c483d1ce4cd.png" />
</div>
</div>
</section>
<section id="ex-3">
<h2>Ex 3<a class="headerlink" href="#ex-3" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># range [separatrix, 45]</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># range [0.0, 0.7]</span>

<span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">400.0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">e0</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">xI</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                                  <span class="n">Phi_phi0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_theta0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">Phi_r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">OmegaPhi</span><span class="p">,</span> <span class="n">OmegaTheta</span><span class="p">,</span> <span class="n">OmegaR</span> <span class="o">=</span> <span class="n">get_fundamental_frequencies</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="c1"># we need to divide by the total Mass and convert to seconds</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">OmegaPhi</span> <span class="o">/</span><span class="n">OmegaR</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;e0=</span><span class="si">{</span><span class="n">e0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">OmegaPhi</span> <span class="o">/</span><span class="n">OmegaTheta</span><span class="p">)</span> 


<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Omega_\varphi/\Omega_r$ [1/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/28ac82da003b7ecc79a3f8fd0779b527ab768bf943ddff8d6f3eb59f36c7c5de.png" src="_images/28ac82da003b7ecc79a3f8fd0779b527ab768bf943ddff8d6f3eb59f36c7c5de.png" />
</div>
</div>
</section>
<section id="ex-4">
<h2>Ex 4<a class="headerlink" href="#ex-4" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amp</span> <span class="o">=</span> <span class="n">RomanAmplitude</span><span class="p">()</span>

<span class="n">teuk_modes</span> <span class="o">=</span> <span class="n">amp</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

<span class="n">ll</span><span class="o">=</span><span class="mi">5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">ll</span><span class="p">,</span><span class="n">ll</span><span class="p">):</span>
    <span class="n">nn</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">teuk_modes</span><span class="p">[:,</span> <span class="n">amp</span><span class="o">.</span><span class="n">special_index_map</span><span class="p">[(</span><span class="n">ll</span><span class="p">,</span><span class="n">mm</span><span class="p">,</span><span class="n">nn</span><span class="p">)]]),</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;(l,m,n)=(</span><span class="si">{</span><span class="n">ll</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">mm</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">nn</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;|A|&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">ll</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">mm</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">teuk_modes</span><span class="p">[:,</span> <span class="n">amp</span><span class="o">.</span><span class="n">special_index_map</span><span class="p">[(</span><span class="n">ll</span><span class="p">,</span><span class="n">mm</span><span class="p">,</span><span class="n">nn</span><span class="p">)]]),</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;(l,m,n)=(</span><span class="si">{</span><span class="n">ll</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">mm</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">nn</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;|A|&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3a399b5f1354edea0ccca37090dae997c99128feab8d355401fa75fda85b0721.png" src="_images/3a399b5f1354edea0ccca37090dae997c99128feab8d355401fa75fda85b0721.png" />
<img alt="_images/b3acf792d718ea5c4fb739a1f6800c1437cc6644037deda97481ff9ed4f23e6b.png" src="_images/b3acf792d718ea5c4fb739a1f6800c1437cc6644037deda97481ff9ed4f23e6b.png" />
</div>
</div>
<section id="ex-5">
<h3>Ex 5<a class="headerlink" href="#ex-5" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle in source frame</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle in source frame</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dd</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="n">SNR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">inner_product</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span><span class="o">+</span><span class="n">inner_product</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span><span class="n">wave</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span><span class="n">dt</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">dd</span><span class="p">,</span> <span class="n">SNR</span><span class="p">,</span><span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;1/d&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;SNR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">100.0</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="n">SNR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">inner_product</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span><span class="o">+</span><span class="n">inner_product</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span><span class="n">wave</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span><span class="n">dt</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">SNR</span><span class="p">,</span><span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;SNR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cb8aa730883e6135f86a7dbe55cd962f34107c62f073d2b44c892a9f1c67310f.png" src="_images/cb8aa730883e6135f86a7dbe55cd962f34107c62f073d2b44c892a9f1c67310f.png" />
<img alt="_images/00f7a0b8101e8216b0bec1c319b215597bc96703af82ed718ce84dc3bf6ff1ec.png" src="_images/00f7a0b8101e8216b0bec1c319b215597bc96703af82ed718ce84dc3bf6ff1ec.png" />
</div>
</div>
</section>
<section id="ex-6">
<h3>Ex 6<a class="headerlink" href="#ex-6" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle in source frame</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle in source frame</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;inferno&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\log_</span><span class="si">{10}</span><span class="s1">\delta e$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Overlap&#39;</span><span class="p">)</span>
<span class="n">vec</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">logd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>

<span class="n">T</span><span class="o">=</span><span class="mf">0.01</span>
<span class="n">base_sig</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="c1"># M</span>
<span class="n">O</span><span class="o">=</span><span class="p">[]</span>    
<span class="k">for</span> <span class="n">delta</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">delta</span><span class="p">),</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
    <span class="n">O</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">overlap</span><span class="p">(</span><span class="n">base_sig</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">dt</span><span class="p">))</span>

<span class="n">axs</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">logd</span><span class="p">,</span> <span class="n">O</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>

<span class="c1"># mu</span>
<span class="n">O</span><span class="o">=</span><span class="p">[]</span>    
<span class="k">for</span> <span class="n">delta</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">delta</span><span class="p">),</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
    <span class="n">O</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">overlap</span><span class="p">(</span><span class="n">base_sig</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">dt</span><span class="p">))</span>

<span class="n">axs</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">logd</span><span class="p">,</span> <span class="n">O</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;mu&#39;</span><span class="p">)</span>

<span class="c1"># p0</span>
<span class="n">O</span><span class="o">=</span><span class="p">[]</span>    
<span class="k">for</span> <span class="n">delta</span> <span class="ow">in</span> <span class="n">vec</span><span class="p">:</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">delta</span><span class="p">),</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
    <span class="n">O</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">overlap</span><span class="p">(</span><span class="n">base_sig</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">dt</span><span class="p">))</span>

<span class="n">axs</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">logd</span><span class="p">,</span> <span class="n">O</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;p0&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/lorenzosperi/anaconda3/envs/few_env/lib/python3.7/site-packages/few-1.4.11-py3.7-macosx-10.9-x86_64.egg/few/utils/baseclasses.py:430: UserWarning: Mass ratio is outside of generally accepted range for an extreme mass ratio (1e-4). (q=0.00010000009999999998)
  mu / M
/Users/lorenzosperi/anaconda3/envs/few_env/lib/python3.7/site-packages/few-1.4.11-py3.7-macosx-10.9-x86_64.egg/few/utils/baseclasses.py:430: UserWarning: Mass ratio is outside of generally accepted range for an extreme mass ratio (1e-4). (q=0.00010000027825594021)
  mu / M
/Users/lorenzosperi/anaconda3/envs/few_env/lib/python3.7/site-packages/few-1.4.11-py3.7-macosx-10.9-x86_64.egg/few/utils/baseclasses.py:430: UserWarning: Mass ratio is outside of generally accepted range for an extreme mass ratio (1e-4). (q=0.00010000077426368267)
  mu / M
/Users/lorenzosperi/anaconda3/envs/few_env/lib/python3.7/site-packages/few-1.4.11-py3.7-macosx-10.9-x86_64.egg/few/utils/baseclasses.py:430: UserWarning: Mass ratio is outside of generally accepted range for an extreme mass ratio (1e-4). (q=0.00010000215443469002)
  mu / M
/Users/lorenzosperi/anaconda3/envs/few_env/lib/python3.7/site-packages/few-1.4.11-py3.7-macosx-10.9-x86_64.egg/few/utils/baseclasses.py:430: UserWarning: Mass ratio is outside of generally accepted range for an extreme mass ratio (1e-4). (q=0.00010000599484250318)
  mu / M
/Users/lorenzosperi/anaconda3/envs/few_env/lib/python3.7/site-packages/few-1.4.11-py3.7-macosx-10.9-x86_64.egg/few/utils/baseclasses.py:430: UserWarning: Mass ratio is outside of generally accepted range for an extreme mass ratio (1e-4). (q=0.000100016681005372)
  mu / M
/Users/lorenzosperi/anaconda3/envs/few_env/lib/python3.7/site-packages/few-1.4.11-py3.7-macosx-10.9-x86_64.egg/few/utils/baseclasses.py:430: UserWarning: Mass ratio is outside of generally accepted range for an extreme mass ratio (1e-4). (q=0.00010004641588833614)
  mu / M
/Users/lorenzosperi/anaconda3/envs/few_env/lib/python3.7/site-packages/few-1.4.11-py3.7-macosx-10.9-x86_64.egg/few/utils/baseclasses.py:430: UserWarning: Mass ratio is outside of generally accepted range for an extreme mass ratio (1e-4). (q=0.00010012915496650151)
  mu / M
/Users/lorenzosperi/anaconda3/envs/few_env/lib/python3.7/site-packages/few-1.4.11-py3.7-macosx-10.9-x86_64.egg/few/utils/baseclasses.py:430: UserWarning: Mass ratio is outside of generally accepted range for an extreme mass ratio (1e-4). (q=0.00010035938136638047)
  mu / M
/Users/lorenzosperi/anaconda3/envs/few_env/lib/python3.7/site-packages/few-1.4.11-py3.7-macosx-10.9-x86_64.egg/few/utils/baseclasses.py:430: UserWarning: Mass ratio is outside of generally accepted range for an extreme mass ratio (1e-4). (q=0.000101)
  mu / M
</pre></div>
</div>
<img alt="_images/6f62cffc6dec9662c000157b7ad4d11fc1dd8410c736aa905b8077a7460bcf7c.png" src="_images/6f62cffc6dec9662c000157b7ad4d11fc1dd8410c736aa905b8077a7460bcf7c.png" />
</div>
</div>
</section>
<section id="ex-7">
<h3>Ex 7<a class="headerlink" href="#ex-7" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle in source frame</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle in source frame</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">few_gen</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Zxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

<span class="n">time</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">OmegaPhi</span><span class="p">,</span> <span class="n">OmegaTheta</span><span class="p">,</span> <span class="n">OmegaR</span> <span class="o">=</span> <span class="n">get_fundamental_frequencies</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">fharmonic</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">OmegaPhi</span> <span class="o">/</span> <span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">MTSUN_SI</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Zxx</span><span class="p">)),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;gouraud&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">fharmonic</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cb</span><span class="p">,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;STFT Magnitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [sec]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3f04e3b500e6e4e1f1e68282d6dd3caa1b99e497957fbfe297e92ccfcca91f0b.png" src="_images/3f04e3b500e6e4e1f1e68282d6dd3caa1b99e497957fbfe297e92ccfcca91f0b.png" />
</div>
</div>
</section>
<section id="ex-8">
<h3>Ex 8<a class="headerlink" href="#ex-8" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BeyondPN</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">par</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># additional parameter</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>

        <span class="c1"># mass ratio</span>
        <span class="n">epsilon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span>

        <span class="c1"># extract the four evolving parameters</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">y</span>

        
        <span class="c1"># guard against bad integration steps</span>
        <span class="k">if</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="mf">1.0</span> <span class="ow">or</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="mf">1e-6</span> <span class="ow">or</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">6.0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span> <span class="n">e</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        
        <span class="c1"># perform elliptic calculations</span>
        <span class="n">EllipE</span> <span class="o">=</span> <span class="n">ellipe</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mf">6.0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">))</span>
        <span class="n">EllipK</span> <span class="o">=</span> <span class="n">ellipk</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mf">6.0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">))</span>
        <span class="n">EllipPi1</span> <span class="o">=</span> <span class="n">ellippi</span><span class="p">(</span><span class="mi">16</span><span class="o">*</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="mf">12.0</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">p</span><span class="o">*</span><span class="n">p</span><span class="p">),</span> <span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mf">6.0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">))</span>
        <span class="n">EllipPi2</span> <span class="o">=</span> <span class="n">ellippi</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mf">1.0</span><span class="o">+</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mf">6.0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">)),</span> <span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mf">6.0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">))</span>

        <span class="c1"># Azimuthal frequency</span>
        <span class="n">Omega_phi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mf">1.5</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">Sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">EllipPi2</span><span class="o">*</span><span class="p">(</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">EllipE</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span>
              <span class="p">(</span><span class="n">EllipK</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">28</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">EllipK</span> <span class="o">+</span> <span class="n">EllipPi2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">EllipK</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">EllipPi1</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="n">p</span><span class="p">)))</span><span class="o">/</span>
            <span class="p">(</span><span class="n">EllipK</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))))</span>

        <span class="c1"># Post-Newtonian calculations</span>
        <span class="n">yPN</span> <span class="o">=</span> <span class="n">Power</span><span class="p">(</span><span class="n">Omega_phi</span><span class="p">,</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span>

        <span class="n">EdotPN</span> <span class="o">=</span> <span class="p">(</span><span class="mi">96</span> <span class="o">+</span> <span class="mi">292</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">37</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">15.</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mf">3.5</span><span class="p">))</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">yPN</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">LdotPN</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">yPN</span><span class="p">,</span> <span class="mf">7.</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>

        <span class="c1"># flux: here I modified the fluxes with the new parameter</span>
        <span class="n">Edot</span> <span class="o">=</span> <span class="o">-</span><span class="n">epsilon</span><span class="o">*</span><span class="p">(</span><span class="n">EdotPN</span><span class="p">)</span> 
        <span class="n">Ldot</span> <span class="o">=</span> <span class="o">-</span><span class="n">epsilon</span><span class="o">*</span><span class="p">(</span><span class="n">LdotPN</span><span class="p">)</span>


        <span class="c1"># time derivatives</span>
        <span class="n">pdot</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">Edot</span><span class="o">*</span><span class="n">Sqrt</span><span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">p</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ldot</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">edot</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">Edot</span><span class="o">*</span><span class="n">Sqrt</span><span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">p</span><span class="p">))</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">18</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">Ldot</span><span class="o">*</span><span class="n">Sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">p</span><span class="p">))</span>
        
        <span class="n">pdot</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span> <span class="o">*</span> <span class="n">p</span>
        <span class="n">edot</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span> <span class="o">*</span> <span class="n">e</span>
        
        <span class="n">Phi_phi_dot</span> <span class="o">=</span> <span class="n">Omega_phi</span><span class="p">;</span>

        <span class="n">Phi_r_dot</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">Sqrt</span><span class="p">((</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="n">Pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">EllipK</span> <span class="o">+</span> <span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">EllipPi2</span><span class="o">*</span><span class="p">(</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">EllipE</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">EllipK</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">28</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">EllipK</span> <span class="o">+</span> <span class="n">EllipPi2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">EllipK</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">EllipPi1</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="n">p</span><span class="p">)))</span><span class="o">/</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

        <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">pdot</span><span class="p">,</span> <span class="n">edot</span><span class="p">,</span> <span class="n">Phi_phi_dot</span><span class="p">,</span> <span class="n">Phi_r_dot</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">dydt</span>

<span class="c1"># this is the actual class that implements a PN trajectory. It uses the PN class in the integrator.</span>
<span class="k">class</span> <span class="nc">BeyondPnTrajectory</span><span class="p">(</span><span class="n">TrajectoryBase</span><span class="p">):</span>
    
    <span class="c1"># for common interface with *args and **kwargs</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="c1"># required by the trajectory base class</span>
    <span class="k">def</span> <span class="nf">get_inspiral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># set up quantities and integrator</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>

        <span class="c1"># dimensionless final time</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">T</span> <span class="o">*</span> <span class="n">YRSID_SI</span> <span class="o">/</span> <span class="p">(</span><span class="n">M</span> <span class="o">*</span> <span class="n">MTSUN_SI</span><span class="p">)</span>
        
        <span class="c1"># factor to convert back to seconds</span>
        <span class="n">Msec</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="n">MTSUN_SI</span>
        
        <span class="c1"># mass ratio</span>
        <span class="n">epsilon</span> <span class="o">=</span> <span class="n">mu</span><span class="o">/</span><span class="n">M</span>
        
        <span class="c1"># we define the right hand side of the ODE</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="n">BeyondPN</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        
        <span class="c1"># scipy integrator</span>
        <span class="n">integrator</span> <span class="o">=</span> <span class="n">DOP853</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>

        <span class="n">t_out</span><span class="p">,</span> <span class="n">p_out</span><span class="p">,</span> <span class="n">e_out</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">Phi_phi_out</span><span class="p">,</span> <span class="n">Phi_r_out</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">t_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">p_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
        <span class="n">e_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e0</span><span class="p">)</span>
        <span class="n">Phi_phi_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">Phi_r_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># run the integrator down to T or separatrix</span>
        <span class="n">run</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">while</span> <span class="n">integrator</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span> <span class="ow">and</span> <span class="n">run</span><span class="p">:</span>
            
            <span class="n">integrator</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">integrator</span><span class="o">.</span><span class="n">y</span>
            <span class="n">t_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integrator</span><span class="o">.</span><span class="n">t</span> <span class="o">*</span> <span class="n">Msec</span><span class="p">)</span>
            <span class="n">p_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="n">e_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">Phi_phi_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Phi_phi</span><span class="p">)</span>
            <span class="n">Phi_r_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Phi_r</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
                <span class="n">run</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># read out data. It must return length 6 tuple</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">t_out</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">p_out</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">e_out</span><span class="p">)</span>
        <span class="n">Phi_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Phi_phi_out</span><span class="p">)</span>
        <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Phi_r_out</span><span class="p">)</span>
        
        <span class="c1"># need to add polar info </span>
        <span class="n">Phi_theta</span> <span class="o">=</span> <span class="n">Phi_phi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># by construction</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Phi_theta</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># we provided a new parameter</span>

<span class="c1"># define the trajectory</span>
<span class="n">traj_new</span> <span class="o">=</span> <span class="n">PnTrajectory</span><span class="p">()</span>

<span class="n">zero_beta</span> <span class="o">=</span> <span class="n">traj_new</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">zero_beta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">zero_beta</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> 

<span class="c1"># new traj</span>
<span class="n">beyond_traj</span> <span class="o">=</span> <span class="n">BeyondPnTrajectory</span><span class="p">()</span>
<span class="n">beta</span><span class="o">=</span><span class="mf">1e-2</span>
<span class="n">nonzero_beta</span> <span class="o">=</span> <span class="n">beyond_traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nonzero_beta</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nonzero_beta</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;flux&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pn&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;dt&#39;: 10.0, &#39;max_init_len&#39;: 1000, &#39;err&#39;: 1e-10, &#39;DENSE_STEPPING&#39;: 0, &#39;use_rk4&#39;: False}
(0.0,)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fdff63fa810&gt;
</pre></div>
</div>
<img alt="_images/66e8cf1ac01827201a6a778861a605028901a38b62121a1667db0009e2d05347.png" src="_images/66e8cf1ac01827201a6a778861a605028901a38b62121a1667db0009e2d05347.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">EMRI Waveforms in a nutshell</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-an-extreme-mass-ratio-inspiral">What is an Extreme Mass Ratio Inspiral?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#emri-waveforms">EMRI Waveforms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#each-harmonics-is-characterized-by-three-important-functions-these-will-be-also-different-modules-in-the-code">Each harmonics is characterized by three important functions (these will be also different modules in the code):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-remarks">General Remarks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#emri-parameter-space">EMRI Parameter space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#schwarzschild-eccentric-waveforms">Schwarzschild Eccentric Waveforms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trajectory-module">Trajectory Module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-us-being-by-analysing-a-basic-trajectory">Let us being by analysing a basic trajectory</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-0">Exercise 0</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quasi-keplerian-parameters-p-e">Quasi-Keplerian parameters: <span class="math notranslate nohighlight">\((p,e)\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evolution-of-semi-latus-rectum-and-eccentricity">Evolution of semi-latus rectum and eccentricity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trajectory-duration-as-a-function-of-mass-ratio-eccentricity-semi-latus-rectum">Trajectory duration as a function of mass ratio, eccentricity, semi-latus rectum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-of-plot-above">Discussion of plot above</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#number-of-cycles-and-differences-between-trajectories">Number of cycles and differences between trajectories</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fundamental-frequencies-and-harmonics">Fundamental frequencies and harmonics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#schwarzchild-waveforms-in-the-source-frame">Schwarzchild Waveforms in the source frame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#emri-waveforms-in-different-domains">EMRI Waveforms in different domains</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-domain">Time Domain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier-domain">Fourier Domain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-frequency-domain">Time-Frequency Domain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#end-of-tutorial">End of Tutorial</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#augmented-analytic-kludge-with-5pn-trajectory">Augmented Analytic Kludge with 5PN trajectory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pn-trajectory">5PN Trajectory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-an-aak-waveform-from-a-given-trajectory-in-this-case-the-5pn-trajectory">Building an AAK waveform from a given trajectory (in this case the 5PN trajectory)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-the-new-aak-with-the-generic-waveform-generator">Generating the new AAK with the generic waveform generator</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mode-selection-for-schwarszchild-waveforms">Mode Selection for Schwarszchild Waveforms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mode-selection-by-power-contribution">Mode selection by power contribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specific-mode-selection">Specific mode selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#producing-waveforms-with-the-generic-interface">Producing waveforms with the generic interface</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling-of-the-waveform-with-the-central-black-hole-mass">Scaling of the waveform with the central black hole mass</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-extrinsic-parameters-in-the-solar-system-barycenter-frame">Understanding the extrinsic parameters in the Solar System Barycenter frame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citing-waveforms-and-modules">Citing waveforms and modules</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fast-schwarzschild-eccentric-waveforms">Fast Schwarzschild Eccentric Waveforms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#new-and-improved-aak-with-5pn-trajectory">New and Improved AAK with 5PN Trajectory</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions">Solutions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-1">Ex 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-2">Ex 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-3">Ex 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-4">Ex 4</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-5">Ex 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-6">Ex 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-7">Ex 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ex-8">Ex 8</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Avi
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>